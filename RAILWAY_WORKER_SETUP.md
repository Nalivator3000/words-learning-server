# Railway Worker Setup - Quick Guide

## –ß—Ç–æ —ç—Ç–æ?

**worker-translation.js** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ—Ä–∫–µ—Ä —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –∫—Ä–∞—à–µ–π, –∫–æ—Ç–æ—Ä—ã–π:
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—ã –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (–¥–æ 5 –ø–æ–ø—ã—Ç–æ–∫)
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –≤—Å–µ 215 –ø–∞—Ä –≥–æ—Ç–æ–≤—ã
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç heartbeat –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- ‚úÖ –ò–º–µ–µ—Ç timeout –∑–∞—â–∏—Ç—É (2 —á–∞—Å–∞ –Ω–∞ –±–∞—Ç—á)

---

## –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (3 —à–∞–≥–∞)

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π Service –≤ Railway

1. –û—Ç–∫—Ä–æ–π Railway Dashboard: https://railway.app/
2. –í—ã–±–µ—Ä–∏ –ø—Ä–æ–µ–∫—Ç `words-learning-server`
3. –ù–∞–∂–º–∏ **"+ New"** ‚Üí **"Empty Service"**
4. –ù–∞–∑–æ–≤–∏ —Å–µ—Ä–≤–∏—Å: `translation-worker`

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π Service

**–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:**

1. **Source** ‚Üí –ü–æ–¥–∫–ª—é—á–∏ —Ç–æ—Ç –∂–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   - Repository: `Nalivator3000/words-learning-server`
   - Branch: `main`

2. **Settings** ‚Üí **Deploy**
   - Build Command: _(–æ—Å—Ç–∞–≤—å –ø—É—Å—Ç—ã–º)_
   - Start Command: `npm run worker`

3. **Variables** ‚Üí –°–∫–æ–ø–∏—Ä—É–π –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
   - `DATABASE_URL` - —Å–∫–æ–ø–∏—Ä—É–π –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ main service
   - `NODE_ENV` - —É—Å—Ç–∞–Ω–æ–≤–∏ `production`

### –®–∞–≥ 3: Deploy

1. –ù–∞–∂–º–∏ **"Deploy"** –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
2. –ñ–¥–∏ ~1-2 –º–∏–Ω—É—Ç—ã –ø–æ–∫–∞ —Å–æ–±–µ—Ä–µ—Ç—Å—è
3. –û—Ç–∫—Ä–æ–π **"Logs"** —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å

---

## –ß—Ç–æ —Ç—ã —É–≤–∏–¥–∏—à—å –≤ –ª–æ–≥–∞—Ö

### –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
```
üöÄ TRANSLATION WORKER STARTED
================================================================================
‚è∞ Start time: 25.12.2025, 20:00:00
üìç Environment: production
üîó Database: Connected ‚úÖ
‚è±Ô∏è  Interval: 6 hours
üîÑ Max retries: 5
================================================================================

üîÅ Starting worker loop...

================================================================================
üöÄ BATCH RUN #1
‚è∞ 25.12.2025, 20:00:01
üìä Consecutive failures: 0/5
================================================================================

üéØ PARALLEL TRANSLATION MATRIX BUILDER
...
```

### –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç:
```
üíì Heartbeat - Worker alive | Runs: 1 | Failures: 0
```

### –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –±–∞—Ç—á–∞:
```
================================================================================
‚úÖ BATCH COMPLETED SUCCESSFULLY
‚è±Ô∏è  Duration: 45.2 minutes
üìà Total runs: 1
================================================================================

üìä Progress: 3/215 pairs completed

================================================================================
‚è∏Ô∏è  WAITING FOR NEXT BATCH
Next run: 25.12.2025, 02:00:00
Interval: 6 hours
================================================================================
```

### –ï—Å–ª–∏ –≤—Å–µ –≥–æ—Ç–æ–≤–æ:
```
üéâ ALL TRANSLATIONS COMPLETE!
Total batches run: 72
Worker shutting down...
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Railway Dashboard
1. –û—Ç–∫—Ä–æ–π `translation-worker` service
2. –í–∫–ª–∞–¥–∫–∞ **"Logs"**
3. –ò—â–∏ —Å—Ç—Ä–æ–∫–∏ —Å `üìä Progress:`

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Railway CLI
```bash
railway logs -s translation-worker
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –±–∞–∑—ã
```bash
railway run npm run translate:check
```

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Worker

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:
Railway Dashboard ‚Üí `translation-worker` ‚Üí **"Settings"** ‚Üí **"Remove Service"**

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å:
Railway Dashboard ‚Üí `translation-worker` ‚Üí **"Deploy"** ‚Üí **"Redeploy"**

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å:
Railway Dashboard ‚Üí `translation-worker` ‚Üí **"Logs"** (–∏—â–∏ heartbeat üíì)

---

## –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫

Worker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:

1. **–ö—Ä–∞—à–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞** - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç
2. **–¢–∞–π–º–∞—É—Ç—ã** - —É–±–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å—à–∏–π –ø—Ä–æ—Ü–µ—Å—Å —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞
3. **5 –ø–æ–¥—Ä—è–¥ –æ—à–∏–±–æ–∫** - –ø–∞—É–∑–∞ 30 –º–∏–Ω—É—Ç –∏ —Å–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–∞
4. **SIGTERM/SIGINT** - graceful shutdown —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
5. **Uncaught exceptions** - –ª–æ–≥–∏—Ä—É–µ—Ç –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É

---

## –û—Ü–µ–Ω–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- **1 –±–∞—Ç—á (3 –ø–∞—Ä—ã):** ~30-60 –º–∏–Ω—É—Ç
- **Phase 1 (12 –ø–∞—Ä):** ~2-4 —á–∞—Å–∞ (4 –±–∞—Ç—á–∞)
- **–í—Å–µ 215 –ø–∞—Ä:** ~50-100 —á–∞—Å–æ–≤ (72 –±–∞—Ç—á–∞)

**–° –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 6 —á–∞—Å–æ–≤:**
- 4 –±–∞—Ç—á–∞ –≤ –¥–µ–Ω—å = 12 –ø–∞—Ä/–¥–µ–Ω—å
- 215 –ø–∞—Ä / 12 = **~18 –¥–Ω–µ–π**

---

## Troubleshooting

### Worker –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç
**–ü—Ä–æ–≤–µ—Ä—å:**
- DATABASE_URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Variables
- Start Command = `npm run worker`
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ–¥–∫–ª—é—á–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –ú–Ω–æ–≥–æ –æ—à–∏–±–æ–∫ ECONNRESET
**–†–µ—à–µ–Ω–∏–µ:**
Worker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ retry —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π. –ï—Å–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è:
- –ü—Ä–æ–≤–µ—Ä—å Railway database status
- –ü—Ä–æ–≤–µ—Ä—å –ª–∏–º–∏—Ç—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

### Worker –∑–∞–≤–∏—Å
**–†–µ—à–µ–Ω–∏–µ:**
Timeout –∑–∞—â–∏—Ç–∞ —É–±—å–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
–ò–ª–∏: Redeploy –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Dashboard.

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∑–∞–ø—É—Å–∫–∞

| –ú–µ—Ç–æ–¥ | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|-------|---------------|------------|-----------|
| Railway CLI | ‚ùå –†—É—á–Ω–æ–π | ‚≠ê‚≠ê‚≠ê | –°—Ä–µ–¥–Ω—è—è |
| npm run translate:matrix | ‚ùå –†—É—á–Ω–æ–π | ‚≠ê‚≠ê | –ü—Ä–æ—Å—Ç–∞—è |
| npm run worker (–ª–æ–∫–∞–ª—å–Ω–æ) | ‚ö†Ô∏è –†—É—á–Ω–æ–π —Å—Ç–∞—Ä—Ç | ‚≠ê‚≠ê‚≠ê | –ü—Ä–æ—Å—Ç–∞—è |
| **Railway Worker Service** | ‚úÖ –ü–æ–ª–Ω–∞—è | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –ü—Ä–æ—Å—Ç–∞—è |

---

## –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤

Worker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫–æ–≥–¥–∞ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç 215/215 –ø–∞—Ä.

–¢—ã –º–æ–∂–µ—à—å:
1. –£–¥–∞–ª–∏—Ç—å `translation-worker` service (–±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω)
2. –ò–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –±—É–¥—É—â–µ–µ –¥–ª—è –Ω–æ–≤—ã—Ö —è–∑—ã–∫–æ–≤

---

**–°–æ–∑–¥–∞–Ω–æ:** 2025-12-25
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ deploy üöÄ
**–í—Ä–µ–º—è setup:** ~3 –º–∏–Ω—É—Ç—ã
