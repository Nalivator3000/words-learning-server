const fs = require('fs');
const path = require('path');

// Ключевые слова для определения тем
const themeKeywords = {
  family: [
    'पिता', 'माता', 'भाई', 'बहन', 'पुत्र', 'पुत्री', 'दादा', 'दादी', 'नाना', 'नानी',
    'चाचा', 'चाची', 'बुआ', 'मौसी', 'ममता', 'प्रेम', 'रिश्ता', 'परिवार',
    'पति', 'पत्नी', 'व्यक्ति', 'संबंध', 'शादी', 'विवाह',
    'बाबा', 'अम्मा', 'भैया', 'आंटी', 'दिदी'
  ],
  food: [
    'खाना', 'भोजन', 'रोटी', 'चावल', 'दाल', 'सब्जी', 'फल', 'मीठा', 'लस्सी',
    'चाय', 'पानी', 'दूध', 'शरबत', 'थाली', 'व्यंजन', 'नाश्ता', 'रायता', 'अचार',
    'चटनी', 'नमक', 'मिर्च', 'प्याज', 'लहसुन', 'अदरक', 'तेल', 'मेवे',
    'आलू', 'टमाटर', 'आलू'
  ],
  travel: [
    'यात्रा', 'सफर', 'मंदिर', 'बाजार', 'सड़क', 'रेल', 'गाड़ी', 'हवा',
    'समुद्र', 'पहाड़', 'गाँव', 'शहर', 'देश', 'विदेशी', 'आसमान', 'जमीन', 'रास्ता',
    'पुल', 'पत्थर', 'महल', 'जिला', 'प्रदेश', 'दूरी'
  ],
  home: [
    'घर', 'मकान', 'कमरा', 'दरवाज़ा', 'खिड़की', 'छत', 'घंटी', 'बैठक',
    'रसोई', 'बिस्तर', 'कुर्सी', 'मेज', 'चूल्हा', 'सीढ़ियाँ',
    'दीवार', 'फर्श', 'दर्पण'
  ],
  health: [
    'रोगी', 'रोग', 'स्वास्थ्य', 'वैद्य', 'दवा', 'औषधि', 'छाती', 'सिर', 'पैर',
    'हाथ', 'आँख', 'अंक', 'दाँत', 'कान', 'नाक', 'स्वस्थ', 'बीमार',
    'दर्द', 'चोट', 'बुखार', 'खांसी', 'सर्दी', 'डॉक्टर'
  ],
  work: [
    'काम', 'अमल', 'नौकरी', 'उपज', 'किसान', 'कामकार', 'कर्मचारी', 'दफ्तर',
    'व्यापार', 'व्यापारी', 'बनाव', 'निर्माण', 'शिल्प',
    'कारखाना', 'कंपनी', 'व्यवसाय'
  ],
  education: [
    'शिक्षा', 'विद्या', 'पाठशाला', 'गुरु', 'छात्र', 'पुस्तक', 'लिखा', 'पढ़ाई',
    'विचार', 'ज्ञान', 'बुद्धि', 'परीक्षा', 'विद्यार्थी', 'अध्यापक', 'अक्षर', 'भाषा',
    'शब्द', 'वाक्य', 'प्रश्न', 'उत्तर'
  ],
  nature: [
    'प्रकृति', 'वन', 'पेड़', 'पौधा', 'फल', 'फूल', 'पत्ता', 'मूल',
    'नदी', 'झरना', 'तालाब', 'सरोवर',
    'मिट्टी', 'रेत', 'पत्थर', 'आकाश', 'सूरज', 'चाँद', 'तारे', 'ज्योति', 'प्रकाश',
    'घास', 'जानवर', 'पक्षी'
  ],
  weather: [
    'मौसम', 'गर्मी', 'ठंडी', 'बारिश', 'बादल', 'बिजली', 'गर्जन', 'पवन',
    'हवा', 'ठंड', 'आंधी', 'तूफान', 'बरसात', 'धूप', 'छाया'
  ],
  communication: [
    'बात', 'सुना', 'लिखा', 'बोली', 'वाणी', 'आवाज़', 'शब्द',
    'भाषा', 'विचार', 'वचन', 'सुनना', 'कहना', 'बोल',
    'समाचार', 'संबाद', 'खबर', 'पत्र',
    'बातचीत', 'संवाद', 'भाषण'
  ],
  culture: [
    'संस्कृति', 'परंपरा', 'रीति', 'त्योहार', 'पूजा', 'इबादत', 'देवी', 'देवता',
    'अवतार', 'कथा', 'इतिहास', 'साहित्य', 'कला', 'संगीत', 'नृत्य',
    'भजन', 'कीर्तन', 'यज्ञ', 'मंदिर'
  ],
  emotions: [
    'भाव', 'भावना', 'अनुभव', 'खुशी', 'दुख', 'गुस्सा', 'भय', 'नींद',
    'प्यार', 'ममता', 'शर्म', 'गर्व', 'मान',
    'मित्रता', 'दोस्त', 'स्नेह', 'वात्सल्य',
    'आनंद', 'उदासी', 'चिंता', 'निराशा', 'आशा'
  ],
  sports: [
    'खेल', 'खिलाड़ी', 'दौड़', 'कूद', 'पकड़', 'फेंका', 'मारा',
    'मैदान', 'जीत', 'हार',
    'ताकत', 'शक्ति', 'जोर',
    'क्रिकेट', 'फुटबॉल', 'योग'
  ],
  technology: [
    'यंत्र', 'उपकरण', 'लोहा', 'तत्व', 'धातु', 'तकनीक',
    'विद्या', 'विद्युत', 'शक्ति', 'पदार्थ',
    'कंप्यूटर', 'फोन', 'इंटरनेट', 'विज्ञान'
  ],
  time: [
    'समय', 'घड़ी', 'दिन', 'रात', 'सुबह', 'शाम',
    'प्रभात', 'कल', 'आज', 'अब', 'फिर', 'बाद', 'पहले',
    'सप्ताह', 'महीना', 'साल', 'वर्ष', 'घंटा', 'मिनट'
  ],
  numbers: [
    'एक', 'दो', 'तीन', 'चार', 'पाँच', 'छः', 'सात', 'आठ', 'नौ', 'दस',
    'ग्यारह', 'बारह', 'तेरह', 'चौदह', 'पंद्रह', 'सोलह', 'सत्रह', 'अठारह',
    'उन्नीस', 'बीस', 'तीस', 'चालीस', 'पचास', 'साठ', 'सत्तर', 'अस्सी', 'नब्बे', 'सौ',
    'संख्या', 'अंक'
  ],
  colors: [
    'रंग', 'लाल', 'पीला', 'नीला', 'हरा', 'सफेद', 'काला', 'भूरा', 'ग्रे',
    'गुलाबी', 'बैंगनी', 'नारंगी'
  ],
  clothing: [
    'कपड़ा', 'वस्त्र', 'जामा', 'पैंट', 'शर्ट', 'साड़ी', 'दुपट्टा',
    'ओढ़नी', 'जूती', 'जूता', 'पगड़ी', 'टोपी', 'हार',
    'कंगन', 'चोटी', 'बिंदी', 'तिलक',
    'स्वेटर', 'जैकेट', 'कोट', 'बेल्ट'
  ],
  shopping: [
    'बाजार', 'दुकान', 'व्यापार', 'कीमत', 'दाम', 'खरीद', 'बिक्री', 'व्यापारी',
    'पैसा', 'रुपया', 'आना', 'पैसे',
    'विक्रय', 'क्रय', 'सौदा', 'भाव'
  ]
};

// फ़ंक्शन - मूल शब्द निकालें
function extractBaseWord(word) {
  const match = word.match(/^(.+?)(?:_\d+_[A-Z]+)?$/);
  return match ? match[1] : word;
}

// फ़ंक्शन - शब्द के लिए थीम निर्धारित करें
function getThemeForWord(word) {
  const baseWord = extractBaseWord(word);
  const themes = Object.keys(themeKeywords);

  // सीधी मिलान की जाँच करें
  for (const theme of themes) {
    if (themeKeywords[theme].includes(baseWord)) {
      return theme;
    }
  }

  // आंशिक मिलान की खोज करें
  for (const theme of themes) {
    for (const keyword of themeKeywords[theme]) {
      if (keyword.includes(baseWord) || baseWord.includes(keyword)) {
        return theme;
      }
    }
  }

  // यदि कोई मिलान नहीं मिला, तो हैश के आधार पर असाइन करें
  let hash = 0;
  for (let i = 0; i < baseWord.length; i++) {
    hash += baseWord.charCodeAt(i);
  }
  return themes[hash % themes.length];
}

const inputFile = 'c:\\Users\\Nalivator3000\\words-learning-server\\hindi-words-for-themes.txt';
const outputFile = 'c:\\Users\\Nalivator3000\\words-learning-server\\themes-hindi-all.json';

console.log('Hindi शब्दों से थीम्स की फ़ाइल पढ़ रहे हैं...');

const content = fs.readFileSync(inputFile, 'utf-8');
const lines = content.split('\n').map(l => l.trim()).filter(l => l);

console.log(`कुल लाइनें: ${lines.length}`);

// अद्वितीय मूल शब्दों को संसाधित करें
const seenBaseWords = new Set();
const themesData = [];
const themeCount = {};

for (const theme of Object.keys(themeKeywords)) {
  themeCount[theme] = 0;
}

for (const word of lines) {
  const baseWord = extractBaseWord(word);

  if (!seenBaseWords.has(baseWord)) {
    seenBaseWords.add(baseWord);
    const theme = getThemeForWord(word);
    themesData.push({ word: baseWord, theme });
    themeCount[theme]++;
  }
}

console.log(`\nकुल अद्वितीय शब्द: ${themesData.length}`);

// परिणाम सहेजें
fs.writeFileSync(outputFile, JSON.stringify(themesData, null, 2), 'utf-8');

// आँकड़े दिखाएं
console.log('\nथीम्स के आधार पर आँकड़े:');
const sortedThemes = Object.entries(themeCount).sort((a, b) => b[1] - a[1]);
for (const [theme, count] of sortedThemes) {
  console.log(`  ${theme}: ${count} शब्द`);
}

console.log(`\nपरिणाम सहेजे गए: ${outputFile}`);
