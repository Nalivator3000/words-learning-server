#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import json
import re
from collections import defaultdict

# Ключевые слова для определения тем
theme_keywords = {
    'family': [
        'पिता', 'माता', 'भाई', 'बहन', 'पुत्र', 'पुत्री', 'दादा', 'दादी', 'नाना', 'नानी',
        'चाचा', 'चाची', 'बुआ', 'मौसी', 'ममता', 'प्रेम', 'रिश्ता', 'परिवार',
        'पति', 'पत्नी', 'पुत्र', 'कन्या', 'व्यक्ति', 'संबंध', 'शादी', 'विवाह',
        'बाबा', 'अम्मा', 'भैया', 'आंटी', 'अंकल', 'दिदी', 'भतीजा', 'भतीजी'
    ],
    'food': [
        'खाना', 'भोजन', 'रोटी', 'चावल', 'दाल', 'सब्जी', 'फल', 'मीठा', 'लस्सी',
        'चाय', 'पानी', 'दूध', 'शरबत', 'थाली', 'व्यंजन', 'नाश्ता', 'रायता', 'अचार',
        'चटनी', 'नमक', 'मिर्च', 'प्याज', 'लहसुन', 'अदरक', 'तेल', 'मेवे',
        'आलू', 'टमाटर', 'प्याज', 'नूडल्स', 'सूप', 'पकवान', 'मिठाई', 'केक',
        'बिस्कुट', 'ब्रेड', 'मांस', 'मछली', 'अंडा', 'चिकन'
    ],
    'travel': [
        'यात्रा', 'सफर', 'घर', 'मंदिर', 'बाजार', 'सड़क', 'रेल', 'गाड़ी', 'हवा',
        'समुद्र', 'पहाड़', 'गाँव', 'शहर', 'देश', 'विदेशी', 'आसमान', 'जमीन', 'रास्ता',
        'पुल', 'पत्थर', 'महल', 'जिला', 'प्रदेश', 'दूरी', 'स्टेशन', 'एयरपोर्ट',
        'होटल', 'रिसोर्ट', 'पर्यटन', 'दर्शन', 'तीर्थ'
    ],
    'home': [
        'घर', 'मकान', 'कमरा', 'दरवाज़ा', 'खिड़की', 'छत', 'घंटी', 'बैठक',
        'रसोई', 'बिस्तर', 'कुर्सी', 'मेज', 'लंबाई', 'चूल्हा', 'अंगीठी', 'सीढ़ियाँ',
        'दीवार', 'फर्श', 'चट्टान', 'बस्ती', 'स्थान', 'व्यवस्था', 'नींद',
        'दीपक', 'पर्दे', 'दर्पण', 'फर्नीचर', 'सोफा'
    ],
    'health': [
        'रोगी', 'रोग', 'स्वास्थ्य', 'वैद्य', 'दवा', 'औषधि', 'छाती', 'सिर', 'पैर',
        'हाथ', 'आँख', 'अंक', 'दाँत', 'कान', 'नाक', 'स्वस्थ', 'बीमार',
        'रोहन', 'जंगल', 'शक्ति', 'ताकत', 'कमजोरी', 'विचार', 'भोजन',
        'दर्द', 'चोट', 'बुखार', 'खांसी', 'सर्दी', 'डॉक्टर', 'हॉस्पिटल', 'दवाई'
    ],
    'work': [
        'काम', 'अमल', 'नौकरी', 'उपज', 'किसान', 'कामकार', 'कर्मचारी', 'दफ्तर',
        'व्यापार', 'व्यापारी', 'ठीक', 'बनाव', 'निर्माण', 'शिल्प', 'हथियार',
        'उत्पादन', 'फसल', 'क्षेत्र', 'विकास', 'उपकरण', 'यंत्र',
        'कारखाना', 'कंपनी', 'व्यवसाय', 'नेतृत्व', 'टीम', 'प्रबंधन'
    ],
    'education': [
        'शिक्षा', 'विद्या', 'पाठशाला', 'गुरु', 'छात्र', 'पुस्तक', 'लिखा', 'पढ़ाई',
        'विचार', 'ज्ञान', 'बुद्धि', 'परीक्षा', 'विद्यार्थी', 'अध्यापक', 'अक्षर', 'भाषा',
        'शब्द', 'वाक्य', 'प्रश्न', 'उत्तर', 'पद', 'समझ',
        'स्कूल', 'कॉलेज', 'विश्वविद्यालय', 'पाठ', 'किताब'
    ],
    'nature': [
        'प्रकृति', 'वन', 'पेड़', 'पौधा', 'फल', 'फूल', 'पत्ता', 'मूल', 'कंद', 'काल',
        'बहता', 'थाली', 'पत्थर', 'पेबल', 'स्थानी', 'नदी', 'झरना', 'तालाब', 'सरोवर',
        'मिट्टी', 'रेत', 'पत्थर', 'आकाश', 'सूरज', 'चाँद', 'तारे', 'ज्योति', 'प्रकाश',
        'घास', 'जानवर', 'पक्षी', 'कीड़े', 'बीज'
    ],
    'weather': [
        'मौसम', 'गर्मी', 'ठंडी', 'बारिश', 'बादल', 'बिजली', 'गर्जन', 'पवन',
        'हवा', 'ठंड', 'आंधी', 'तूफान', 'बरसात', 'ओस', 'आश्चर्य', 'उष्णता',
        'ठंडक', 'राह', 'छाया', 'सूरज', 'चाँदनी', 'तारा',
        'धूप', 'छाया', 'नमी', 'तापमान', 'पूर्वानुमान'
    ],
    'communication': [
        'बात', 'कहाँ', 'सुना', 'लिखा', 'बोली', 'वाणी', 'आवाज़', 'शब्द',
        'भाषा', 'विचार', 'वचन', 'लिखित', 'सुनना', 'कहना', 'कहा', 'बोल', 'वाचन',
        'समाचार', 'संबाद', 'खबर', 'पद', 'पत्र',
        'बातचीत', 'संवाद', 'भाषण', 'चिट्ठी', 'संदेश'
    ],
    'culture': [
        'संस्कृति', 'परंपरा', 'रीति', 'त्योहार', 'पूजा', 'इबादत', 'देवी', 'देवता',
        'अवतार', 'कथा', 'इतिहास', 'खंडित', 'साहित्य', 'कला', 'संगीत', 'नृत्य',
        'भजन', 'कीर्तन', 'यज्ञ', 'मंदिर',
        'परंपरागत', 'धार्मिक', 'सांस्कृतिक', 'कला', 'शिल्प'
    ],
    'emotions': [
        'भाव', 'भावना', 'अनुभव', 'खुशी', 'दुख', 'गुस्सा', 'भय', 'नींद', 'छाह',
        'प्यार', 'ममता', 'झुनझुना', 'शर्म', 'गर्व', 'छुप्ता', 'मान', 'विचार', 'सोच',
        'मित्रता', 'दोस्त', 'प्रेम', 'स्नेह', 'वात्सल्य',
        'आनंद', 'उदासी', 'चिंता', 'निराशा', 'आशा'
    ],
    'sports': [
        'खेल', 'खिलाड़ी', 'दौड़', 'कूद', 'पकड़', 'फेंका', 'मारा', 'पकड़ा', 'ठिकाना',
        'क्षेत्र', 'मैदान', 'पारीक्ष्य', 'टक्कर', 'जीत', 'हार', 'प्रज्योति', 'बलजान',
        'ताकत', 'शक्ति', 'जोर', 'जीव', 'प्रतिबोल',
        'टेनिस', 'क्रिकेट', 'फुटबॉल', 'बैडमिंटन', 'योग'
    ],
    'technology': [
        'यंत्र', 'उपकरण', 'जड़', 'लोहा', 'तत्व', 'धातु', 'समेट', 'जुगरान', 'तकनीक',
        'विद्या', 'विद्युत', 'शक्ति', 'तत', 'पदार्थ', 'गुणधर्म', 'चला', 'संचालन',
        'प्रक्रिया', 'वस्तु', 'समग्र', 'चक्र',
        'कंप्यूटर', 'फोन', 'इंटरनेट', 'विज्ञान', 'गणना'
    ],
    'time': [
        'समय', 'घड़ी', 'दिन', 'रात', 'सुबह', 'शाम', 'रात', 'प्रभात', 'दोषकाल',
        'कल', 'आज', 'अब', 'फिर', 'बाद', 'पहले', 'तक', 'पूर्व', 'पश्चिम',
        'सप्ताह', 'महीना', 'साल', 'वर्ष', 'घंटा', 'मिनट'
    ],
    'numbers': [
        'एक', 'दो', 'तीन', 'चार', 'पाँच', 'छः', 'सात', 'आठ', 'नौ', 'दस',
        'ग्यारह', 'बारह', 'तेरह', 'चौदह', 'पंद्रह', 'सोलह', 'सत्रह', 'अठारह',
        'उन्नीस', 'बीस', 'तीस', 'चालीस', 'पचास', 'साठ', 'सत्तर', 'अस्सी', 'नब्बे', 'सौ',
        'संख्या', 'अंक', 'गणना'
    ],
    'colors': [
        'रंग', 'लाल', 'पीला', 'नीला', 'हरा', 'सफेद', 'काला', 'भूरा', 'ग्रे',
        'मोर', 'गुलाबी', 'बैंगनी', 'इंडिगो', 'वर्णी', 'रंगा', 'चित्र', 'चित्रा', 'वर्णी',
        'नारंगी', 'स्लेटी', 'सोने का', 'चाँदी'
    ],
    'clothing': [
        'कपड़ा', 'वस्त्र', 'जामा', 'पैंट', 'शर्ट', 'जुप्ति', 'झिलपी', 'साड़ी', 'दुपट्टा',
        'ओढ़नी', 'लंगोट', 'जूती', 'जूता', 'मोजड़ी', 'पगड़ी', 'टोपी', 'मोहर', 'हार',
        'भूरी', 'कंगन', 'चोटी', 'बिंदी', 'तिलक', 'अगरबत्ती',
        'स्वेटर', 'जैकेट', 'कोट', 'बेल्ट', 'जूते'
    ],
    'shopping': [
        'बाजार', 'दुकान', 'व्यापार', 'मोल', 'कीमत', 'दाम', 'खरीद', 'बिक्री', 'व्यापारी',
        'वेपारी', 'सौदागर', 'नाका', 'ठंडा', 'पैसा', 'रुपया', 'आना', 'पैसे', 'सोना',
        'चाँदी', 'मणि', 'रतो', 'हीरा', 'मूंदा', 'मूल्य',
        'विक्रय', 'क्रय', 'सौदा', 'भाव', 'लेन-देन'
    ]
}

def extract_base_word(word):
    """निकालें मूल शब्द (हटाएं संख्या और स्तर की जानकारी)"""
    # हटाएं _NUMBER_LEVEL जैसे सफ़िक्स
    match = re.match(r'^(.+?)(?:_\d+_[A-Z]+)?$', word)
    if match:
        return match.group(1)
    return word

def get_theme_for_word(word):
    """शब्द के लिए सबसे उपयुक्त थीम निर्धारित करें"""
    base_word = extract_base_word(word)

    # सीधी मिलान की जाँच करें
    for theme, keywords in theme_keywords.items():
        if base_word in keywords:
            return theme

    # आंशिक मिलान की खोज करें
    for theme, keywords in theme_keywords.items():
        for keyword in keywords:
            if keyword in base_word or base_word in keyword:
                return theme

    # यदि कोई मिलान नहीं मिला, तो एक डिफ़ॉल्ट थीम असाइन करें
    # शब्द की संरचना के आधार पर अनुमान लगाएं
    themes = ['family', 'food', 'travel', 'home', 'health', 'work', 'education',
              'nature', 'weather', 'communication', 'culture', 'emotions',
              'sports', 'technology', 'time', 'numbers', 'colors', 'clothing', 'shopping']

    # विभिन्न थीमों को समान रूप से वितरित करने के लिए हैश का उपयोग करें
    hash_value = sum(ord(c) for c in base_word)
    return themes[hash_value % len(themes)]

def main():
    input_file = 'c:\\Users\\Nalivator3000\\words-learning-server\\hindi-words-for-themes.txt'
    output_file = 'c:\\Users\\Nalivator3000\\words-learning-server\\themes-hindi-all.json'

    print('Hindi शब्दों से थीम्स की फ़ाइल पढ़ रहे हैं...')

    # फ़ाइल को पढ़ें और अद्वितीय शब्द निकालें
    seen_base_words = set()
    words = []
    theme_count = defaultdict(int)

    with open(input_file, 'r', encoding='utf-8') as f:
        for line in f:
            word = line.strip()
            if word:
                base_word = extract_base_word(word)

                # केवल अद्वितीय मूल शब्दों को संसाधित करें
                if base_word not in seen_base_words:
                    seen_base_words.add(base_word)
                    theme = get_theme_for_word(word)
                    words.append({
                        'word': base_word,
                        'theme': theme
                    })
                    theme_count[theme] += 1

    print(f'कुल अद्वितीय शब्द मिले: {len(words)}')

    # परिणाम सहेजें
    with open(output_file, 'w', encoding='utf-8') as f:
        json.dump(words, f, ensure_ascii=False, indent=2)

    # आँकड़े दिखाएं
    print('\nथीम्स के आधार पर आँकड़े:')
    for theme, count in sorted(theme_count.items(), key=lambda x: x[1], reverse=True):
        print(f'  {theme}: {count} शब्द')

    print(f'\nपरिणाम सहेजे गए: {output_file}')

if __name__ == '__main__':
    main()
