<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FluentFlow - Language Learning & SRS</title>
    <meta name="description" content="Master languages with spaced repetition, gamification & streak tracking. Learn German, Spanish, French, and more!">
    <!-- Version: v5.0.0-ANDROID-READY -->

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#6366f1">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="FluentFlow">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="FluentFlow">

    <!-- Android-specific meta tags -->
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">

    <!-- Disable caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- Google Sign-In API (optional, for real OAuth) -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <script>
        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('‚úÖ Service Worker registered:', registration.scope);

                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    console.log('üîÑ New version available! Refresh to update.');
                                    if (confirm('–î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –û–±–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å?')) {
                                        newWorker.postMessage({ type: 'SKIP_WAITING' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('‚ùå Service Worker registration failed:', error);
                    });
            });

            // Listen for controller change (new SW activated)
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                console.log('üîÑ Service Worker updated, reloading...');
                window.location.reload();
            });
        }

        // Load stylesheets
        (function() {

            // Load CSS with timestamp to bust cache
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = 'style.css?v=' + Date.now();
            document.head.appendChild(link);

            // Load gamification CSS
            const gamificationLink = document.createElement('link');
            gamificationLink.rel = 'stylesheet';
            gamificationLink.href = 'gamification.css?v=' + Date.now();
            document.head.appendChild(gamificationLink);
        })();
    </script>
</head>
<body>
    <!-- Authentication Modal -->
    <div id="authModal" class="auth-modal">
        <div class="auth-content">
            <h2 data-translate="welcome">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
            <div id="authTabs" class="auth-tabs">
                <button id="loginTab" class="auth-tab active" data-translate="login">–í–æ–π—Ç–∏</button>
                <button id="registerTab" class="auth-tab" data-translate="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            
            <div id="loginForm" class="auth-form active">
                <input type="email" id="loginEmail" data-translate="email" placeholder="Email" required>
                <input type="password" id="loginPassword" data-translate="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <button id="loginBtn" class="auth-btn" data-translate="login">–í–æ–π—Ç–∏</button>
                <div class="auth-divider">–∏–ª–∏</div>
                <button id="googleLoginBtn" class="auth-btn google-btn" data-translate="loginWithGoogle">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google</button>
            </div>
            
            <div id="registerForm" class="auth-form">
                <input type="text" id="registerName" data-translate="name" placeholder="–ò–º—è" required>
                <input type="email" id="registerEmail" data-translate="email" placeholder="Email" required>
                <input type="password" id="registerPassword" data-translate="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <input type="password" id="registerPasswordConfirm" data-translate="confirmPassword" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                <button id="registerBtn" class="auth-btn" data-translate="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            
            <div id="authError" class="auth-error"></div>
        </div>
    </div>

    <div class="container">
        <header class="app-header">
            <div class="header-left">
                <h1 data-translate="appTitle">German Words Learning</h1>
            </div>
            <nav class="header-nav">
                <div class="nav-buttons">
                    <button id="homeBtn" class="nav-btn active" data-translate="home" data-label="Home">–ì–ª–∞–≤–Ω–∞—è</button>
                    <button id="importBtn" class="nav-btn" data-translate="import" data-label="Import">–ò–º–ø–æ—Ä—Ç</button>
                    <button id="studyBtn" class="nav-btn" data-translate="study" data-label="Study">–ò–∑—É—á–µ–Ω–∏–µ</button>
                    <button id="reviewBtn" class="nav-btn" data-translate="review" data-label="Review">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</button>
                    <button id="leaderboardBtn" class="nav-btn" data-translate="leaderboard" data-label="Rating">Rating</button>
                    <button id="statsBtn" class="nav-btn" data-translate="statistics" data-label="Stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                </div>
            </nav>
            <div class="header-right">
                <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon">üåô</span>
                </button>
                <button id="userMenuBtn" class="settings-btn">‚öôÔ∏è</button>
                <div id="userMenu" class="user-menu hidden">
                    <button id="settingsBtn" data-translate="settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                    <button id="logoutBtn" data-translate="logout">–í—ã–π—Ç–∏</button>
                </div>
            </div>
        </header>

        <div class="user-info-bar">
            <span id="userInfo" class="user-info"></span>
            <div id="gamificationHeader" class="gamification-header-container"></div>
        </div>

        <main>
            <!-- Home Section -->
            <section id="homeSection" class="section active">
                <h2 data-translate="dashboard">German Words Learning Dashboard</h2>

                <!-- Daily Goals -->
                <div id="dailyGoalsContainer"></div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 data-translate="studyingWords">–ò–∑—É—á–∞–µ–º—ã–µ —Å–ª–æ–≤–∞</h3>
                        <p id="studyingCount">0</p>
                    </div>
                    <div class="stat-card">
                        <h3 data-translate="reviewWords">–ù–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–∏</h3>
                        <p id="reviewCount">0</p>
                    </div>
                    <div class="stat-card">
                        <h3 data-translate="learnedWords">–ò–∑—É—á–µ–Ω–æ</h3>
                        <p id="learnedCount">0</p>
                    </div>
                </div>
                <div class="quick-actions">
                    <button id="quickStudyBtn" class="action-btn" data-translate="quickStudy">–ë—ã—Å—Ç—Ä–æ–µ –∏–∑—É—á–µ–Ω–∏–µ</button>
                    <button id="quickReviewBtn" class="action-btn" data-translate="quickReview">–ë—ã—Å—Ç—Ä–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</button>
                </div>
            </section>

            <!-- Import Section -->
            <section id="importSection" class="section">
                <h2 data-translate="importWords">–ò–º–ø–æ—Ä—Ç —Å–ª–æ–≤</h2>

                <!-- CSV Template Download -->
                <div class="template-download">
                    <p style="margin-bottom: 10px;">
                        <strong>üì• –°–∫–∞—á–∞–π—Ç–µ —à–∞–±–ª–æ–Ω CSV –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è:</strong>
                    </p>
                    <button id="downloadTemplateBtn" class="action-btn secondary-btn">
                        üìÑ –°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω CSV
                    </button>
                    <p style="margin-top: 10px; font-size: 14px; color: #6c757d;">
                        –®–∞–±–ª–æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫ –∏ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
                    </p>
                </div>

                <hr style="margin: 30px 0; border: none; border-top: 1px solid #e0e0e0;">

                <div class="import-options">
                    <div class="import-card">
                        <h3>–ò–∑ CSV —Ñ–∞–π–ª–∞</h3>
                        <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV —Ñ–∞–π–ª —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: –°–ª–æ–≤–æ, –ü—Ä–∏–º–µ—Ä, –ü–µ—Ä–µ–≤–æ–¥, –ü–µ—Ä–µ–≤–æ–¥ –ø—Ä–∏–º–µ—Ä–∞</p>
                        <input type="file" id="csvInput" accept=".csv" style="display: none;">
                        <button id="csvImportBtn" class="action-btn">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</button>
                    </div>
                    <div class="import-card">
                        <h3>–ò–∑ Google –¢–∞–±–ª–∏—Ü</h3>
                        <p>–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –ø—É–±–ª–∏—á–Ω—É—é Google —Ç–∞–±–ª–∏—Ü—É</p>
                        <input type="text" id="googleSheetsUrl" placeholder="https://docs.google.com/spreadsheets/...">
                        <button id="googleImportBtn" class="action-btn">–ò–º–ø–æ—Ä—Ç</button>
                    </div>
                </div>
                <div id="importStatus" class="status-message"></div>
            </section>

            <!-- Study Section -->
            <section id="studySection" class="section">
                <h2 data-translate="study">–ò–∑—É—á–µ–Ω–∏–µ</h2>
                <div class="quiz-container">
                    <div id="studyModeSelect" class="mode-select">
                        <h3 data-translate="selectMode">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –∏–∑—É—á–µ–Ω–∏—è:</h3>
                        <div class="mode-grid">
                            <button id="multipleChoiceBtn" class="mode-btn"><span data-translate="multipleChoice">–í—ã–±–æ—Ä –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</span><br><small>(—Ä–æ–¥–Ω–æ–π ‚Üí –∏–∑—É—á–∞–µ–º—ã–π)</small></button>
                            <button id="reverseMultipleChoiceBtn" class="mode-btn"><span data-translate="reverseChoice">–û–±—Ä–∞—Ç–Ω—ã–π –≤—ã–±–æ—Ä</span><br><small>(–∏–∑—É—á–∞–µ–º—ã–π ‚Üí —Ä–æ–¥–Ω–æ–π)</small></button>
                            <button id="wordBuildingBtn" class="mode-btn"><span data-translate="wordBuilding">–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞</span><br><small>–∏–∑ –±—É–∫–≤</small></button>
                            <button id="typingBtn" class="mode-btn"><span data-translate="typing">–í–≤–æ–¥ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã</span><br><small>(—Ä–æ–¥–Ω–æ–π ‚Üí –∏–∑—É—á–∞–µ–º—ã–π)</small></button>
                            <button id="survivalBtn" class="mode-btn survival-mode"><span data-translate="survivalMode">–†–µ–∂–∏–º –≤—ã–∂–∏–≤–∞–Ω–∏—è</span><br><small>5 —Å–µ–∫ –Ω–∞ –æ—Ç–≤–µ—Ç, –¥–æ 3 –æ—à–∏–±–æ–∫</small></button>
                            <button id="complexModeBtn" class="mode-btn complex-mode"><span data-translate="complexMode">–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ä–µ–∂–∏–º</span><br><small>–≤—Å–µ —Ç–∏–ø—ã –ø–æ–¥—Ä—è–¥</small></button>
                        </div>
                    </div>
                    <div id="quizArea" class="quiz-area hidden">
                        <div class="progress-bar">
                            <div id="progressFill" class="progress-fill"></div>
                        </div>
                        <div id="questionCounter" class="counter">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 10</div>
                        <div id="questionText" class="question"></div>
                        <div id="answerArea" class="answer-area"></div>
                        <div id="feedback" class="feedback"></div>
                        <button id="nextBtn" class="action-btn hidden">–î–∞–ª–µ–µ</button>
                        <button id="finishStudyBtn" class="action-btn hidden">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                    </div>
                    
                    <!-- Survival Mode Area -->
                    <div id="survivalArea" class="survival-area hidden">
                        <div class="survival-stats">
                            <div class="survival-stat">
                                <span class="stat-label">–°—á—ë—Ç:</span>
                                <span id="survivalScore" class="stat-value">0</span>
                            </div>
                            <div class="survival-stat">
                                <span class="stat-label">–û—à–∏–±–∫–∏:</span>
                                <span id="survivalErrors" class="stat-value">0/3</span>
                            </div>
                            <div class="survival-stat">
                                <span class="stat-label">–í—Ä–µ–º—è:</span>
                                <span id="survivalTime" class="stat-value">5</span>
                            </div>
                        </div>
                        
                        <div class="survival-timer">
                            <div id="timerBarLeft" class="timer-bar left"></div>
                            <div id="timerBarRight" class="timer-bar right"></div>
                        </div>
                        
                        <div id="survivalQuestion" class="survival-question"></div>
                        
                        <div id="survivalChoices" class="survival-choices">
                            <button id="choice1" class="survival-choice">–°–ª–æ–≤–æ 1</button>
                            <button id="choice2" class="survival-choice">–°–ª–æ–≤–æ 2</button>
                        </div>
                        
                        <div id="survivalFeedback" class="survival-feedback"></div>
                        
                        <div class="survival-controls">
                            <small style="opacity: 0.7;">
                                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: <kbd>‚Üê</kbd><kbd>‚Üí</kbd> –∏–ª–∏ <kbd>‚Üë</kbd><kbd>‚Üì</kbd> –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞, 
                                <kbd>1</kbd><kbd>2</kbd> –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã–±–æ—Ä–∞, 
                                <kbd>Enter</kbd> –∏–ª–∏ <kbd>–ü—Ä–æ–±–µ–ª</kbd> –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ
                            </small>
                        </div>
                        
                        <button id="survivalRestart" class="action-btn hidden">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                        <button id="survivalExit" class="action-btn hidden">–í—ã–π—Ç–∏</button>
                    </div>
                </div>
            </section>

            <!-- Review Section -->
            <section id="reviewSection" class="section">
                <h2 data-translate="review">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</h2>
                <div class="review-info">
                    <p data-translate="reviewWords">–°–ª–æ–≤–∞ –Ω–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ:</p>
                    <div class="review-stats">
                        <span>7 –¥–Ω–µ–π: <span id="review7Count">0</span></span>
                        <span>30 –¥–Ω–µ–π: <span id="review30Count">0</span></span>
                    </div>
                </div>
                <div class="quiz-container">
                    <div id="reviewModeSelect" class="mode-select">
                        <button id="startReviewBtn" class="action-btn" data-translate="startReview">–ù–∞—á–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</button>
                    </div>
                    <div id="reviewQuizArea" class="quiz-area hidden">
                        <div class="progress-bar">
                            <div id="reviewProgressFill" class="progress-fill"></div>
                        </div>
                        <div id="reviewQuestionCounter" class="counter">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 10</div>
                        <div id="reviewQuestionText" class="question"></div>
                        <div id="reviewAnswerArea" class="answer-area"></div>
                        <div id="reviewFeedback" class="feedback"></div>
                        <button id="reviewNextBtn" class="action-btn hidden">–î–∞–ª–µ–µ</button>
                        <button id="finishReviewBtn" class="action-btn hidden">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                    </div>
                </div>
            </section>

            <!-- Statistics Section -->
            <section id="statsSection" class="section">
                <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <div class="stats-detailed">
                    <div class="export-section">
                        <h3>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
                        <button id="exportStudyingBtn" class="export-btn">–≠–∫—Å–ø–æ—Ä—Ç –∏–∑—É—á–∞–µ–º—ã—Ö —Å–ª–æ–≤</button>
                        <button id="exportReviewBtn" class="export-btn">–≠–∫—Å–ø–æ—Ä—Ç —Å–ª–æ–≤ –Ω–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–∏</button>
                        <button id="exportLearnedBtn" class="export-btn">–≠–∫—Å–ø–æ—Ä—Ç –∏–∑—É—á–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤</button>
                        <button id="exportAllBtn" class="export-btn">–≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Å–ª–æ–≤</button>
                    </div>
                    <div class="word-lists">
                        <div class="list-section">
                            <h3>–ò–∑—É—á–∞–µ–º—ã–µ —Å–ª–æ–≤–∞ (<span id="studyingListCount">0</span>)</h3>
                            <div id="studyingList" class="word-list"></div>
                        </div>
                        <div class="list-section">
                            <h3>–ù–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–∏ (<span id="reviewListCount">0</span>)</h3>
                            <div id="reviewList" class="word-list"></div>
                        </div>
                        <div class="list-section">
                            <h3>–ò–∑—É—á–µ–Ω–æ (<span id="learnedListCount">0</span>)</h3>
                            <div id="learnedList" class="word-list"></div>
                        </div>
                    </div>
                    <!-- Analytics Section -->
                    <div class="analytics-section">
                        <h3>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è</h3>

                        <!-- Learning Progress Chart -->
                        <div class="progress-chart-container">
                            <div class="chart-header">
                                <div class="chart-title">–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è</div>
                                <div class="chart-period-selector">
                                    <button class="period-btn active" data-period="week">Week</button>
                                    <button class="period-btn" data-period="month">–ú–µ—Å—è—Ü</button>
                                    <button class="period-btn" data-period="year">–ì–æ–¥</button>
                                </div>
                            </div>
                            <div class="chart-canvas-wrapper">
                                <canvas id="progressChart"></canvas>
                            </div>
                        </div>

                        <!-- Exercise Success Rate -->
                        <div class="exercise-stats-container">
                            <div class="exercise-stats-header">
                                <h3>‚úÖ –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –ø–æ —Ç–∏–ø–∞–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</h3>
                                <p class="exercise-stats-description">–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö</p>
                            </div>
                            <div class="chart-canvas-wrapper" style="height: 250px;">
                                <canvas id="exerciseStatsChart"></canvas>
                            </div>
                        </div>

                        <!-- Study Time Tracking -->
                        <div class="study-time-container">
                            <h3>‚è±Ô∏è –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è</h3>
                            <div id="studyTimeStats"></div>
                        </div>

                        <!-- Difficult Words -->
                        <div class="difficult-words-container">
                            <h3>üéØ –°–∞–º—ã–µ —Å–ª–æ–∂–Ω—ã–µ —Å–ª–æ–≤–∞</h3>
                            <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 16px;">
                                –°–ª–æ–≤–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã —á–∞—â–µ –≤—Å–µ–≥–æ –æ—à–∏–±–∞–µ—Ç–µ—Å—å
                            </p>
                            <div id="difficultWordsList"></div>
                        </div>

                        <!-- Fluency Prediction -->
                        <div class="fluency-prediction-container">
                            <h3>üîÆ –ü—Ä–æ–≥–Ω–æ–∑ –±–µ–≥–ª–æ—Å—Ç–∏</h3>
                            <div id="fluencyPrediction"></div>
                        </div>
                    </div>

                    <!-- Gamification Stats -->
                    <div id="gamificationStatsContainer" class="gamification-section">
                        <!-- Gamification stats will be rendered here by gamification.js -->
                    </div>
                    <!-- Danger Zone - Reset Progress (moved to bottom) -->
                    <div class="export-section" style="margin-top: 40px; border-top: 2px solid #f44336; padding-top: 20px;">
                        <h3 style="color: #f44336;">‚ö†Ô∏è –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h3>
                        <button id="resetAllToStudyingBtn" class="export-btn" style="background: #f44336; color: white;">
                            üîÑ –°–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å
                        </button>
                        <p style="font-size: 12px; color: #f44336; margin-top: 10px; font-weight: 600;">
                            ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç –≤—Å–µ —Å–ª–æ–≤–∞ –Ω–∞ "–∏–∑—É—á–µ–Ω–∏–µ" –∏ –æ–±–Ω—É–ª–∏—Ç –≤—Å–µ –±–∞–ª–ª—ã! –ù–µ–æ–±—Ä–∞—Ç–∏–º–æ!
                        </p>
                    </div>
                </div>
            </section>

            <!-- Leaderboard Section -->
            <section id="leaderboardSection" class="section">
                <h2>üèÜ Leaderboard</h2>
                <div class="leaderboard-tabs">
                    <button id="globalLeaderboardTab" class="tab-btn active">üåç Global</button>
                    <button id="weeklyLeaderboardTab" class="tab-btn">üìÖ Week</button>
                </div>
                <div id="userRankCard" class="user-rank-card">
                    <!-- User's rank will be displayed here -->
                </div>
                <div id="leaderboardContainer" class="leaderboard-container">
                    <!-- Leaderboard will be rendered here -->
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settingsSection" class="section">
                <h2 data-translate="settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <div class="settings-content">
                    <div class="settings-group">
                        <h3 data-translate="uiLanguage">–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</h3>
                        <select id="uiLanguageSelect" class="language-select">
                            <option value="ru">–†—É—Å—Å–∫–∏–π (Russian)</option>
                            <option value="en">English</option>
                            <option value="de">Deutsch (German)</option>
                            <option value="es">Espa√±ol (Spanish)</option>
                            <option value="fr">Fran√ßais (French)</option>
                            <option value="it">Italiano (Italian)</option>
                        </select>
                    </div>

                    <div class="settings-group">
                        <h3 data-translate="languagePairs">–Ø–∑—ã–∫–æ–≤—ã–µ –ø–∞—Ä—ã</h3>
                        <div class="language-pairs">
                            <div id="languagePairsList" class="language-pairs-list"></div>
                            <button id="addLanguagePairBtn" class="action-btn" data-translate="addLanguagePair">–î–æ–±–∞–≤–∏—Ç—å —è–∑—ã–∫–æ–≤—É—é –ø–∞—Ä—É</button>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3 data-translate="studySettings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—É—á–µ–Ω–∏—è</h3>
                        <label>
                            <span data-translate="wordsPerLesson">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –≤ —É—Ä–æ–∫–µ:</span>
                            <input type="number" id="lessonSizeInput" min="5" max="50" value="10">
                        </label>
                    </div>

                    <div class="settings-group">
                        <h3>üîä –û–∑–≤—É—á–∫–∞ (Text-to-Speech)</h3>
                        <div id="voiceSettings" class="voice-settings">
                            <div class="voice-language-section">
                                <h4>–†—É—Å—Å–∫–∏–π (ru-RU)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-ru-RU" class="voice-select">
                                        <option value="auto">–ê–≤—Ç–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="ru-RU" title="–ü—Ä–æ—Å–ª—É—à–∞—Ç—å –ø—Ä–∏–º–µ—Ä">üîä</button>
                                </div>
                            </div>

                            <div class="voice-language-section">
                                <h4>–ê–Ω–≥–ª–∏–π—Å–∫–∏–π (en-US)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-en-US" class="voice-select">
                                        <option value="auto">Auto (recommended)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="en-US" title="Play sample">üîä</button>
                                </div>
                            </div>

                            <div class="voice-language-section">
                                <h4>–ù–µ–º–µ—Ü–∫–∏–π (de-DE)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-de-DE" class="voice-select">
                                        <option value="auto">Automatisch (empfohlen)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="de-DE" title="Beispiel anh√∂ren">üîä</button>
                                </div>
                            </div>

                            <div class="voice-language-section">
                                <h4>–ò—Å–ø–∞–Ω—Å–∫–∏–π (es-ES)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-es-ES" class="voice-select">
                                        <option value="auto">Auto (recomendado)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="es-ES" title="Escuchar ejemplo">üîä</button>
                                </div>
                            </div>

                            <div class="voice-language-section">
                                <h4>–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π (fr-FR)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-fr-FR" class="voice-select">
                                        <option value="auto">Auto (recommand√©)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="fr-FR" title="√âcouter l'exemple">üîä</button>
                                </div>
                            </div>

                            <div class="voice-language-section">
                                <h4>–ò—Ç–∞–ª—å—è–Ω—Å–∫–∏–π (it-IT)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-it-IT" class="voice-select">
                                        <option value="auto">Automatico (consigliato)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="it-IT" title="Ascolta esempio">üîä</button>
                                </div>
                            </div>

                            <p class="voice-info">
                                ‚ÑπÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–º–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –Ω–∞–∏–ª—É—á—à–µ–≥–æ –≥–æ–ª–æ—Å–∞ –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.
                            </p>

                            <div class="voice-controls-section">
                                <h4>‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–∑–≤—É—á–∫–∏</h4>

                                <div class="voice-control">
                                    <label for="voiceRateSlider">
                                        <span>–°–∫–æ—Ä–æ—Å—Ç—å: <span id="voiceRateValue">0.8x</span></span>
                                        <small style="color: #6c757d;">–ú–µ–¥–ª–µ–Ω–Ω–µ–µ = –ª—É—á—à–µ –¥–ª—è –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</small>
                                    </label>
                                    <input type="range" id="voiceRateSlider" min="0.5" max="1.5" step="0.1" value="0.8" class="voice-slider">
                                    <div class="slider-labels">
                                        <span>0.5x</span>
                                        <span>1.0x</span>
                                        <span>1.5x</span>
                                    </div>
                                </div>

                                <div class="voice-control">
                                    <label for="voicePitchSlider">
                                        <span>–¢–æ–Ω: <span id="voicePitchValue">1.0</span></span>
                                        <small style="color: #6c757d;">–í—ã—Å–æ—Ç–∞ –≥–æ–ª–æ—Å–∞</small>
                                    </label>
                                    <input type="range" id="voicePitchSlider" min="0.5" max="2.0" step="0.1" value="1.0" class="voice-slider">
                                    <div class="slider-labels">
                                        <span>–ù–∏–∑–∫–∏–π</span>
                                        <span>–ù–æ—Ä–º–∞–ª—å–Ω—ã–π</span>
                                        <span>–í—ã—Å–æ–∫–∏–π</span>
                                    </div>
                                </div>

                                <div class="voice-control">
                                    <label for="voiceVolumeSlider">
                                        <span>–ì—Ä–æ–º–∫–æ—Å—Ç—å: <span id="voiceVolumeValue">100%</span></span>
                                    </label>
                                    <input type="range" id="voiceVolumeSlider" min="0" max="1" step="0.1" value="1" class="voice-slider">
                                    <div class="slider-labels">
                                        <span>0%</span>
                                        <span>50%</span>
                                        <span>100%</span>
                                    </div>
                                </div>

                                <button id="testVoiceSettingsBtn" class="action-btn" style="margin-top: 10px;">
                                    üîä –¢–µ—Å—Ç —Å —Ç–µ–∫—É—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</h3>
                        <button id="syncBtn" class="action-btn" data-translate="sync">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º</button>
                        <div id="syncStatus" class="sync-status"></div>
                    </div>

                    <div class="settings-group">
                        <h3>üëã –û–±—É—á–µ–Ω–∏–µ</h3>
                        <p style="font-size: 14px; color: #6c757d; margin-bottom: 12px;">
                            –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç—É—Ä –ø–æ —Ñ—É–Ω–∫—Ü–∏—è–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                        </p>
                        <button id="restartOnboardingBtn" class="action-btn secondary-btn">
                            üéØ –ù–∞—á–∞—Ç—å —Ç—É—Ä –∑–∞–Ω–æ–≤–æ
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Version Info -->
<!--         <footer style="position: fixed; bottom: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 5px; font-size: 12px; z-index: 10000;">
            v5.0.0-FIX-f0e645b
        </footer> -->

        <!-- New Version Indicator -->
        <div id="newVersionIndicator" style="position: fixed; top: 10px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #8B5CF6, #06B6D4); color: white; padding: 10px 20px; border-radius: 25px; font-weight: bold; z-index: 10001; box-shadow: 0 4px 12px rgba(0,0,0,0.3); animation: pulse 2s infinite;">
            ‚ú® NEW VERSION LOADED! ‚ú®
        </div>

        <style>
            @keyframes pulse {
                0% { transform: translateX(-50%) scale(1); }
                50% { transform: translateX(-50%) scale(1.05); }
                100% { transform: translateX(-50%) scale(1); }
            }
        </style>

        <script>
            // Hide indicator after 5 seconds
            setTimeout(() => {
                const indicator = document.getElementById('newVersionIndicator');
                if (indicator) {
                    indicator.style.transition = 'opacity 1s ease-out';
                    indicator.style.opacity = '0';
                    setTimeout(() => indicator.remove(), 1000);
                }
            }, 5000);
        </script>
    </div>

    <!-- Chart.js for analytics visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <script src="theme.js"></script>
    <script src="toast.js"></script>
    <script src="api-database.js"></script>
    <script src="quiz.js"></script>
    <script src="language-manager.js"></script>
    <script src="user-manager.js"></script>
    <script src="survival-mode.js"></script>
    <script src="gamification.js"></script>
    <script src="analytics.js"></script>
    <script src="onboarding.js"></script>
    <script src="app.js"></script>
</body>
</html>