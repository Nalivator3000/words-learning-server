<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LexyBooster - Language Learning & SRS</title>
    <meta name="description" content="Master languages with spaced repetition, gamification & streak tracking. Learn German, Spanish, French, and more!">
    <!-- Version: v5.0.0-ANDROID-READY -->

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-72x72.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-72x72.png">
    <link rel="shortcut icon" href="/icons/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/icon-128x128.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#6366f1">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="LexyBooster">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="LexyBooster">

    <!-- Android-specific meta tags -->
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">

    <!-- Disable caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- Google Sign-In API (optional, for real OAuth) -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <script>
        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('‚úÖ Service Worker registered:', registration.scope);

                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    console.log('üîÑ New version available! Refresh to update.');
                                    showUpdateNotification(newWorker);
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('‚ùå Service Worker registration failed:', error);
                    });
            });

            // Listen for controller change (new SW activated)
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                console.log('üîÑ Service Worker updated, reloading...');
                window.location.reload();
            });
        }

        // Show update notification banner
        function showUpdateNotification(newWorker) {
            // Create notification banner
            const banner = document.createElement('div');
            banner.id = 'update-banner';
            banner.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
                color: white;
                padding: 16px 20px;
                text-align: center;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                animation: slideDown 0.3s ease-out;
            `;

            banner.innerHTML = `
                <div style="max-width: 600px; margin: 0 auto; display: flex; align-items: center; justify-content: center; gap: 16px; flex-wrap: wrap;">
                    <span style="font-weight: 600;">üîÑ ${i18n?.t ? i18n.t('app_update_available') : 'A new version is available!'}</span>
                    <button id="update-btn" style="
                        background: white;
                        color: #6366f1;
                        border: none;
                        padding: 8px 20px;
                        border-radius: 8px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: transform 0.2s;
                    " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        ${i18n?.t ? i18n.t('confirm') : 'Update Now'}
                    </button>
                </div>
            `;

            document.body.appendChild(banner);

            // Add animation styles
            if (!document.getElementById('update-banner-style')) {
                const style = document.createElement('style');
                style.id = 'update-banner-style';
                style.textContent = `
                    @keyframes slideDown {
                        from { transform: translateY(-100%); }
                        to { transform: translateY(0); }
                    }
                `;
                document.head.appendChild(style);
            }

            // Handle update button click
            document.getElementById('update-btn').addEventListener('click', () => {
                newWorker.postMessage({ type: 'SKIP_WAITING' });
                banner.remove();
            });
        }

        // Load stylesheets
        (function() {

            // Load CSS with timestamp to bust cache
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = 'style.css?v=' + Date.now();
            document.head.appendChild(link);

            // Load gamification CSS
            const gamificationLink = document.createElement('link');
            gamificationLink.rel = 'stylesheet';
            gamificationLink.href = 'gamification.css?v=' + Date.now();
            document.head.appendChild(gamificationLink);

            // Load features UI CSS
            const featuresLink = document.createElement('link');
            featuresLink.rel = 'stylesheet';
            featuresLink.href = 'features-ui.css?v=' + Date.now();
            document.head.appendChild(featuresLink);

            // Load leagues UI CSS
            const leaguesLink = document.createElement('link');
            leaguesLink.rel = 'stylesheet';
            leaguesLink.href = 'leagues-ui.css?v=' + Date.now();
            document.head.appendChild(leaguesLink);

            // Load weekly challenges UI CSS
            const weeklyChallengesLink = document.createElement('link');
            weeklyChallengesLink.rel = 'stylesheet';
            weeklyChallengesLink.href = 'weekly-challenges-ui.css?v=' + Date.now();
            document.head.appendChild(weeklyChallengesLink);

            // Load personal rating UI CSS
            const personalRatingLink = document.createElement('link');
            personalRatingLink.rel = 'stylesheet';
            personalRatingLink.href = 'personal-rating-ui.css?v=' + Date.now();
            document.head.appendChild(personalRatingLink);

            // Load personal insights UI CSS
            const personalInsightsLink = document.createElement('link');
            personalInsightsLink.rel = 'stylesheet';
            personalInsightsLink.href = 'personal-insights-ui.css?v=' + Date.now();
            document.head.appendChild(personalInsightsLink);

            // Load friends UI CSS
            const friendsLink = document.createElement('link');
            friendsLink.rel = 'stylesheet';
            friendsLink.href = 'friends-ui.css?v=' + Date.now();
            document.head.appendChild(friendsLink);

            // Load duels UI CSS
            const duelsLink = document.createElement('link');
            duelsLink.rel = 'stylesheet';
            duelsLink.href = 'duels-ui.css?v=' + Date.now();
            document.head.appendChild(duelsLink);

            // Load duel gameplay CSS
            const duelGameplayLink = document.createElement('link');
            duelGameplayLink.rel = 'stylesheet';
            duelGameplayLink.href = 'duel-gameplay.css?v=' + Date.now();
            document.head.appendChild(duelGameplayLink);

            // Load profile UI CSS
            const profileLink = document.createElement('link');
            profileLink.rel = 'stylesheet';
            profileLink.href = 'profile-ui.css?v=' + Date.now();
            document.head.appendChild(profileLink);

            // Load achievements UI CSS
            const achievementsLink = document.createElement('link');
            achievementsLink.rel = 'stylesheet';
            achievementsLink.href = 'achievements-ui.css?v=' + Date.now();
            document.head.appendChild(achievementsLink);

            // Load word lists UI CSS
            const wordListsLink = document.createElement('link');
            wordListsLink.rel = 'stylesheet';
            wordListsLink.href = 'word-lists-ui.css?v=' + Date.now();
            document.head.appendChild(wordListsLink);
        })();
    </script>
</head>
<body>
    <!-- Authentication Modal -->
    <div id="authModal" class="auth-modal">
        <div class="auth-content">
            <h2 data-i18n="welcome">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
            <div id="authTabs" class="auth-tabs">
                <button id="loginTab" class="auth-tab active" data-i18n="login">–í–æ–π—Ç–∏</button>
                <button id="registerTab" class="auth-tab" data-i18n="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            
            <div id="loginForm" class="auth-form active">
                <input type="email" id="loginEmail" data-i18n="email" placeholder="Email" required>
                <input type="password" id="loginPassword" data-i18n="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <button id="loginBtn" class="auth-btn" data-i18n="login">–í–æ–π—Ç–∏</button>
                <div class="auth-divider">–∏–ª–∏</div>
                <button id="googleLoginBtn" class="auth-btn google-btn" data-i18n="loginWithGoogle">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google</button>
            </div>
            
            <div id="registerForm" class="auth-form">
                <input type="text" id="registerName" data-i18n="name" placeholder="–òm—è" required>
                <input type="email" id="registerEmail" data-i18n="email" placeholder="Email" required>
                <input type="password" id="registerPassword" data-i18n="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <input type="password" id="registerPasswordConfirm" data-i18n="confirmPassword" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>

                <div class="language-selection">
                    <label>I speak:</label>
                    <select id="registerNativeLang">
                        <option value="en">English</option>
                        <option value="de">German</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="ru">Russian</option>
                        <option value="uk">Ukrainian</option>
                        <option value="pt">Portuguese</option>
                        <option value="it">Italian</option>
                        <option value="zh">Chinese</option>
                        <option value="ja">Japanese</option>
                        <option value="ko">Korean</option>
                    </select>
                </div>

                <div class="language-selection">
                    <label>I want to learn:</label>
                    <select id="registerTargetLang">
                        <option value="en">English</option>
                        <option value="de">German</option>
                        <option value="es" selected>Spanish</option>
                        <option value="fr">French</option>
                        <option value="ru">Russian</option>
                        <option value="uk">Ukrainian</option>
                        <option value="pt">Portuguese</option>
                        <option value="it">Italian</option>
                        <option value="zh">Chinese</option>
                        <option value="ja">Japanese</option>
                        <option value="ko">Korean</option>
                    </select>
                </div>

                <button id="registerBtn" class="auth-btn" data-i18n="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            
            <div id="authError" class="auth-error"></div>
        </div>
    </div>

    <div class="container">
        <header class="app-header">
            <div class="header-left">
                <h1 data-i18n="appTitle">German Words Learning</h1>
            </div>
            <nav class="header-nav">
                <div class="nav-buttons">
                    <button id="homeBtn" class="nav-btn active" data-i18n="home" data-label="Home"></button>
                    <button id="importBtn" class="nav-btn" data-i18n="import" data-label="Import"></button>
                    <button id="wordListsBtn" class="nav-btn" data-i18n="word_lists" data-label="Word Lists"></button>
                    <button id="studyBtn" class="nav-btn" data-i18n="study" data-label="Study"></button>
                    <button id="reviewBtn" class="nav-btn" data-i18n="review" data-label="Review"></button>
                    <button id="challengesBtn" class="nav-btn" data-i18n="daily_challenges" data-label="Challenges"></button>
                    <button id="leaguesBtn" class="nav-btn" data-i18n="leagues_title" data-label="Leagues" style="display: none;"></button>
                    <button id="weeklyChallengesBtn" class="nav-btn" data-i18n="weekly_challenges_title" data-label="Weekly" style="display: none;"></button>
                    <button id="personalRatingBtn" class="nav-btn" data-i18n="personal_rating_title" data-label="Rating" style="display: none;"></button>
                    <button id="personalInsightsBtn" class="nav-btn" data-i18n="personal_insights_title" data-label="Insights" style="display: none;"></button>
                    <button id="friendsBtn" class="nav-btn" data-i18n="friends_title" data-label="Friends" style="display: none;"></button>
                    <button id="duelsBtn" class="nav-btn" data-i18n="duels_title" data-label="Duels" style="display: none;"></button>
                    <button id="achievementsBtn" class="nav-btn" data-i18n="achievements_title" data-label="Achievements" style="display: none;"></button>
                    <button id="leaderboardBtn" class="nav-btn" data-i18n="leaderboard" data-label="Rating"></button>
                    <button id="statsBtn" class="nav-btn" data-i18n="statistics" data-label="Stats"></button>
                </div>
            </nav>
            <div class="header-right">
                <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon">üåô</span>
                </button>
                <button id="userMenuBtn" class="settings-btn">‚öôÔ∏è</button>
                <div id="userMenu" class="user-menu hidden">
                    <button id="settingsBtn" data-i18n="settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                    <button id="logoutBtn" data-i18n="logout">–í—ã–π—Ç–∏</button>
                </div>
            </div>
        </header>

        <div class="user-info-bar">
            <span id="userInfo" class="user-info"></span>
        </div>

        <main>
            <!-- Home Section -->
            <section id="homeSection" class="section active">
                <h2 data-i18n="dashboard"></h2>

                <!-- Daily Goals -->
                <div id="dailyGoalsContainer"></div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 data-i18n="studyingWords">–ò–∑—É—á–∞–µm—ã–µ —Å–ª–æ–≤–∞</h3>
                        <p id="studyingCount">0</p>
                    </div>
                    <div class="stat-card">
                        <h3 data-i18n="reviewWords">For Review</h3>
                        <p id="reviewCount">0</p>
                    </div>
                    <div class="stat-card">
                        <h3 data-i18n="learnedWords">Learned</h3>
                        <p id="learnedCount">0</p>
                    </div>
                </div>
                <div class="quick-actions">
                    <button id="quickStudyBtn" class="action-btn" data-i18n="quickStudy">–ë—ã—Å—Ç—Ä–æ–µ –∏–∑—É—á–µ–Ω–∏–µ</button>
                    <button id="quickReviewBtn" class="action-btn" data-i18n="quickReview">–ë—ã—Å—Ç—Ä–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</button>
                </div>
            </section>

            <!-- Import Section -->
            <section id="importSection" class="section">
                <h2 data-i18n="importWords">–òm–ø–æ—Ä—Ç —Å–ª–æ–≤</h2>

                <!-- CSV Template Download -->
                <div class="template-download">
                    <p style="margin-bottom: 10px;">
                        <strong>üì• Download CSV template:</strong>
                    </p>
                    <button id="downloadTemplateBtn" class="action-btn secondary-btn">
                        üìÑ Download CSV Template
                    </button>
                    <p style="margin-top: 10px; font-size: 14px; color: #6c757d;">
                        Template contains correct column headers and examples
                    </p>
                </div>

                <hr style="margin: 30px 0; border: none; border-top: 1px solid #e0e0e0;">

                <div class="import-options">
                    <div class="import-card">
                        <h3 data-i18n="fromCSVFile">From CSV File</h3>
                        <p>Upload CSV file with columns: Word, Example, Translation, Example Translation</p>
                        <input type="file" id="csvInput" accept=".csv" style="display: none;">
                        <button id="csvImportBtn" class="action-btn" data-i18n="selectFile">Select File</button>
                    </div>
                    <div class="import-card">
                        <h3 data-i18n="fromGoogleSheets">From Google Sheets</h3>
                        <p>Paste link to public Google spreadsheet</p>
                        <input type="text" id="googleSheetsUrl" placeholder="https://docs.google.com/spreadsheets/...">
                        <button id="googleImportBtn" class="action-btn" data-i18n="import">–ò–º–ø–æ—Ä—Ç</button>
                    </div>
                </div>
                <div id="importStatus" class="status-message"></div>
            </section>

            <!-- Word Lists Section -->
            <section id="wordListsSection" class="section">
                <h2>üìö <span data-i18n="word_lists">Word Lists</span></h2>
                <p class="section-description" data-i18n="word_lists_description">
                    Browse and import curated word collections by topic, level, and language
                </p>

                <div id="wordListsContent">
                    <!-- Word Lists UI will be rendered here by JavaScript -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </section>

            <!-- Study Section -->
            <section id="studySection" class="section">
                <h2 data-i18n="study">–ò–∑—É—á–µ–Ω–∏–µ</h2>
                <div class="quiz-container">
                    <div id="studyModeSelect" class="mode-select">
                        <h3 data-i18n="selectMode" data-i18n="selectMode">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –∏–∑—É—á–µ–Ω–∏—è:</h3>
                        <div class="mode-grid">
                            <button id="multipleChoiceBtn" class="mode-btn"><span data-i18n="multipleChoice">–í—ã–±–æ—Ä –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</span><br><small>(native ‚Üí target)</small></button>
                            <button id="reverseMultipleChoiceBtn" class="mode-btn"><span data-i18n="reverseChoice">–û–±—Ä–∞—Ç–Ω—ã–π –≤—ã–±–æ—Ä</span><br><small>(target ‚Üí native)</small></button>
                            <button id="wordBuildingBtn" class="mode-btn"><span data-i18n="wordBuilding">Word Building</span><br><small>from letters</small></button>
                            <button id="typingBtn" class="mode-btn"><span data-i18n="typing">–í–≤–æ–¥ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã</span><br><small>(native ‚Üí target)</small></button>
                            <button id="survivalBtn" class="mode-btn survival-mode"><span data-i18n="survivalMode" data-i18n="survivalMode">–†–µ–∂–∏–º –≤—ã–∂–∏–≤–∞–Ω–∏—è</span><br><small>5 sec per answer, up to 3 errors</small></button>
                            <button id="complexModeBtn" class="mode-btn complex-mode"><span data-i18n="complexMode" data-i18n="complexMode">–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ä–µ–∂–∏–º</span><br><small>all types in sequence</small></button>
                        </div>
                    </div>
                    <div id="quizArea" class="quiz-area hidden">
                        <div class="progress-bar">
                            <div id="progressFill" class="progress-fill"></div>
                        </div>
                        <div id="questionCounter" class="counter">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 10</div>
                        <div id="questionText" class="question"></div>
                        <div id="answerArea" class="answer-area"></div>
                        <div id="feedback" class="feedback"></div>
                        <button id="nextBtn" class="action-btn hidden" data-i18n="next">–î–∞–ª–µ–µ</button>
                        <button id="finishStudyBtn" class="action-btn hidden" data-i18n="finish">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                    </div>
                    
                    <!-- Survival Mode Area -->
                    <div id="survivalArea" class="survival-area hidden">
                        <div class="survival-stats">
                            <div class="survival-stat">
                                <span class="stat-label" data-i18n="score">–°—á—ë—Ç:</span>
                                <span id="survivalScore" class="stat-value">0</span>
                            </div>
                            <div class="survival-stat">
                                <span class="stat-label" data-i18n="errors">–û—à–∏–±–∫–∏:</span>
                                <span id="survivalErrors" class="stat-value">0/3</span>
                            </div>
                            <div class="survival-stat">
                                <span class="stat-label" data-i18n="time">–í—Ä–µ–º—è:</span>
                                <span id="survivalTime" class="stat-value">5</span>
                            </div>
                        </div>
                        
                        <div class="survival-timer">
                            <div id="timerBarLeft" class="timer-bar left"></div>
                            <div id="timerBarRight" class="timer-bar right"></div>
                        </div>
                        
                        <div id="survivalQuestion" class="survival-question"></div>
                        
                        <div id="survivalChoices" class="survival-choices">
                            <button id="choice1" class="survival-choice" data-i18n="word_1">–°–ª–æ–≤–æ 1</button>
                            <button id="choice2" class="survival-choice">–°–ª–æ–≤–æ 2</button>
                        </div>
                        
                        <div id="survivalFeedback" class="survival-feedback"></div>
                        
                        <div class="survival-controls">
                            <small style="opacity: 0.7;">
                                <span data-i18n="controls">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</span> <kbd>‚Üê</kbd><kbd>‚Üí</kbd> <span data-i18n="or">–∏–ª–∏</span> <kbd>‚Üë</kbd><kbd>‚Üì</kbd> <span data-i18n="instant_answer">–¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞,</span> 
                                <kbd>1</kbd><kbd>2</kbd> <span data-i18n="quick_choice">–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã–±–æ—Ä–∞,</span> 
                                <kbd>Enter</kbd> –∏–ª–∏ <kbd data-i18n="space">–ü—Ä–æ–±–µ–ª</kbd> –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ
                            </small>
                        </div>
                        
                        <button id="survivalRestart" class="action-btn hidden">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                        <button id="survivalExit" class="action-btn hidden">–í—ã–π—Ç–∏</button>
                    </div>
                </div>
            </section>

            <!-- Review Section -->
            <section id="reviewSection" class="section">
                <h2 data-i18n="review">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</h2>
                <div class="review-info">
                    <p data-i18n="reviewWords">Words –Ω–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ:</p>
                    <div class="review-stats">
                        <span>7 days: <span id="review7Count">0</span></span>
                        <span>30 days: <span id="review30Count">0</span></span>
                    </div>
                </div>
                <div class="quiz-container">
                    <div id="reviewModeSelect" class="mode-select">
                        <button id="startReviewBtn" class="action-btn" data-i18n="startReview">–ù–∞—á–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</button>
                    </div>
                    <div id="reviewQuizArea" class="quiz-area hidden">
                        <div class="progress-bar">
                            <div id="reviewProgressFill" class="progress-fill"></div>
                        </div>
                        <div id="reviewQuestionCounter" class="counter">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 10</div>
                        <div id="reviewQuestionText" class="question"></div>
                        <div id="reviewAnswerArea" class="answer-area"></div>
                        <div id="reviewFeedback" class="feedback"></div>
                        <button id="reviewNextBtn" class="action-btn hidden" data-i18n="next">–î–∞–ª–µ–µ</button>
                        <button id="finishReviewBtn" class="action-btn hidden" data-i18n="finish">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                    </div>
                </div>
            </section>

            <!-- Statistics Section -->
            <section id="statsSection" class="section">
                <!-- XP Progress Bar -->
                <div id="gamificationHeader" class="gamification-header-container" style="margin-bottom: 20px;"></div>

                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                    <h2 style="margin: 0;">Statistics</h2>
                    <a href="srs-explanation.html" target="_blank" class="help-link" title="How does the spaced repetition system work?">
                        ‚ÑπÔ∏è How it works
                    </a>
                </div>
                <div class="stats-detailed">
                    <div class="export-section">
                        <h3 data-i18n="exportData">Export Data</h3>
                        <button id="exportStudyingBtn" class="export-btn">Export Learning Words</button>
                        <button id="exportReviewBtn" class="export-btn">Export Review Words</button>
                        <button id="exportLearnedBtn" class="export-btn">Export Learned Words</button>
                        <button id="exportAllBtn" class="export-btn">Export All Words</button>
                    </div>
                    <div class="word-lists">
                        <div class="list-section">
                            <h3>Learning Words (<span id="studyingListCount">0</span>)</h3>
                            <div id="studyingList" class="word-list"></div>
                        </div>
                        <div class="list-section">
                            <h3>For Review (<span id="reviewListCount">0</span>)</h3>
                            <div id="reviewList" class="word-list"></div>
                        </div>
                        <div class="list-section">
                            <h3>Learned (<span id="learnedListCount">0</span>)</h3>
                            <div id="learnedList" class="word-list"></div>
                        </div>
                    </div>
                    <!-- Analytics Section -->
                    <div class="analytics-section">
                        <h3>üìä Learning Analytics</h3>

                        <!-- Learning Progress Chart -->
                        <div class="progress-chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Learning Progress Chart</div>
                                <div class="chart-period-selector">
                                    <button class="period-btn active" data-period="week">Week</button>
                                    <button class="period-btn" data-period="month">Month</button>
                                    <button class="period-btn" data-period="year">Year</button>
                                </div>
                            </div>
                            <div class="chart-canvas-wrapper">
                                <canvas id="progressChart"></canvas>
                            </div>
                        </div>

                        <!-- Exercise Success Rate -->
                        <div class="exercise-stats-container">
                            <div class="exercise-stats-header">
                                <h3>‚úÖ Success Rate by Exercise Type</h3>
                                <p class="exercise-stats-description">Percentage of correct answers in different modes</p>
                            </div>
                            <div class="chart-canvas-wrapper" style="height: 250px;">
                                <canvas id="exerciseStatsChart"></canvas>
                            </div>
                        </div>

                        <!-- Study Time Tracking -->
                        <div class="study-time-container">
                            <h3>‚è±Ô∏è Study Time</h3>
                            <div id="studyTimeStats"></div>
                        </div>

                    </div>

                    <!-- Gamification Stats -->
                    <div id="gamificationStatsContainer" class="gamification-section">
                        <!-- Gamification stats will be rendered here by gamification.js -->
                    </div>
                    <!-- Danger Zone - Reset Progress (moved to bottom) -->
                    <div class="export-section" style="margin-top: 40px; border-top: 2px solid #f44336; padding-top: 20px;">
                        <h3 style="color: #f44336;">‚ö†Ô∏è Danger Zone</h3>
                        <button id="resetAllToStudyingBtn" class="export-btn" style="background: #f44336; color: white;" onclick="console.log('Button clicked!'); if(window.app) { window.app.resetAllProgress(); } else { alert('App not initialized'); }">
                            üîÑ Reset All Progress
                        </button>
                        <p style="font-size: 12px; color: #f44336; margin-top: 10px; font-weight: 600;">
                            ‚ö†Ô∏è WARNING: This will move all words to "learning" and reset all points! Irreversible!
                        </p>
                    </div>
                </div>
            </section>

            <!-- Leaderboard Section -->
            <section id="leaderboardSection" class="section">
                <h2>üèÜ Leaderboard</h2>
                <div class="leaderboard-tabs">
                    <button id="globalLeaderboardTab" class="tab-btn active">üåç Global</button>
                    <button id="weeklyLeaderboardTab" class="tab-btn">üìÖ Week</button>
                </div>
                <div id="userRankCard" class="user-rank-card">
                    <!-- User's rank will be displayed here -->
                </div>
                <div id="leaderboardContainer" class="leaderboard-container">
                    <!-- Leaderboard will be rendered here -->
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settingsSection" class="section">
                <h2 data-i18n="settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <div class="settings-content">
                    <div class="settings-group">
                        <h3 data-i18n="uiLanguage">–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</h3>
                        <select id="uiLanguageSelect" class="language-select">
                            <option value="ru" data-i18n="russian">–†—É—Å—Å–∫–∏–π (Russian)</option>
                            <option value="en">English</option>
                            <option value="de">Deutsch (German)</option>
                            <option value="es">Espa√±ol (Spanish)</option>
                            <option value="fr">Fran√ßais (French)</option>
                            <option value="it">Italiano (Italian)</option>
                        </select>
                    </div>

                    <div class="settings-group">
                        <h3 data-i18n="languagePairs">–Ø–∑—ã–∫–æ–≤—ã–µ –ø–∞—Ä—ã</h3>
                        <div class="language-pairs">
                            <div id="languagePairsList" class="language-pairs-list"></div>
                            <button id="addLanguagePairBtn" class="action-btn" data-i18n="addLanguagePair">–î–æ–±–∞–≤–∏—Ç—å —è–∑—ã–∫–æ–≤—É—é –ø–∞—Ä—É</button>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3 data-i18n="studySettings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—É—á–µ–Ω–∏—è</h3>
                        <label>
                            <span data-i18n="wordsPerLesson">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –≤ —É—Ä–æ–∫–µ:</span>
                            <input type="number" id="lessonSizeInput" min="5" max="50" value="10">
                        </label>
                    </div>

                    <div class="settings-group">
                        <h3>üéØ Daily Goals</h3>
                        <label style="display: flex; flex-direction: column; gap: 8px; margin-bottom: 16px;">
                            <span>Daily XP Goal:</span>
                            <input type="number" id="dailyXPGoalInput" min="10" max="1000" step="10" value="50" style="padding: 8px; border-radius: 8px;">
                        </label>
                        <label style="display: flex; flex-direction: column; gap: 8px; margin-bottom: 16px;">
                            <span>Words to Learn Daily:</span>
                            <input type="number" id="dailyWordsGoalInput" min="1" max="50" value="5" style="padding: 8px; border-radius: 8px;">
                        </label>
                        <label style="display: flex; flex-direction: column; gap: 8px;">
                            <span>Exercises to Complete Daily:</span>
                            <input type="number" id="dailyExercisesGoalInput" min="1" max="100" value="10" style="padding: 8px; border-radius: 8px;">
                        </label>
                        <button id="saveDailyGoalsBtn" class="action-btn" style="margin-top: 16px;">Save Goals</button>
                    </div>

                    <!-- TTS Settings hidden - too complex for basic users -->
                    <!--
                    <div class="settings-group">
                        <h3>üîä Text-to-Speech</h3>
                        <div id="voiceSettings" class="voice-settings">
                            <div class="voice-language-section">
                                <h4>Russian (ru-RU)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-ru-RU" class="voice-select">
                                        <option value="auto" data-i18n="auto_recommended">–ê–≤—Ç–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="ru-RU" title="–ü—Ä–æ—Å–ª—É—à–∞—Ç—å –ø—Ä–∏–º–µ—Ä" data-i18n-title="listen_example">üîä</button>
                                </div>
                            </div>

                            <div class="voice-language-section">
                                <h4>English (en-US)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-en-US" class="voice-select">
                                        <option value="auto">Auto (recommended)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="en-US" title="Play sample">üîä</button>
                                </div>
                            </div>

                            <div class="voice-language-section">
                                <h4 data-i18n="german_de">–ù–µ–º–µ—Ü–∫–∏–π (de-DE)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-de-DE" class="voice-select">
                                        <option value="auto">Automatisch (empfohlen)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="de-DE" title="Beispiel anh√∂ren">üîä</button>
                                </div>
                            </div>

                            <div class="voice-language-section">
                                <h4>Spanish (es-ES)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-es-ES" class="voice-select">
                                        <option value="auto">Auto (recomendado)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="es-ES" title="Escuchar ejemplo">üîä</button>
                                </div>
                            </div>

                            <div class="voice-language-section">
                                <h4>French (fr-FR)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-fr-FR" class="voice-select">
                                        <option value="auto">Auto (recommand√©)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="fr-FR" title="√âcouter l'exemple">üîä</button>
                                </div>
                            </div>

                            <div class="voice-language-section">
                                <h4>Italian (it-IT)</h4>
                                <div class="voice-selector">
                                    <select id="voiceSelect-it-IT" class="voice-select">
                                        <option value="auto">Automatico (consigliato)</option>
                                    </select>
                                    <button class="voice-preview-btn" data-lang="it-IT" title="Ascolta esempio">üîä</button>
                                </div>
                            </div>

                            <p class="voice-info">
                                ‚ÑπÔ∏è <span data-i18n="auto_voice_info">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–º–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –Ω–∞–∏–ª—É—á—à–µ–≥–æ –≥–æ–ª–æ—Å–∞ –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</span>
                            </p>

                            <div class="voice-controls-section">
                                <h4 data-i18n="voice_parameters">‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–∑–≤—É—á–∫–∏</h4>

                                <div class="voice-control">
                                    <label for="voiceRateSlider">
                                        <span>Speed: <span id="voiceRateValue">0.8x</span></span>
                                        <small style="color: #6c757d;">Slower = better for memorization</small>
                                    </label>
                                    <input type="range" id="voiceRateSlider" min="0.5" max="1.5" step="0.1" value="0.8" class="voice-slider">
                                    <div class="slider-labels">
                                        <span>0.5x</span>
                                        <span>1.0x</span>
                                        <span>1.5x</span>
                                    </div>
                                </div>

                                <div class="voice-control">
                                    <label for="voicePitchSlider">
                                        <span>Pitch: <span id="voicePitchValue">1.0</span></span>
                                        <small style="color: #6c757d;">Voice pitch</small>
                                    </label>
                                    <input type="range" id="voicePitchSlider" min="0.5" max="2.0" step="0.1" value="1.0" class="voice-slider">
                                    <div class="slider-labels">
                                        <span>Low</span>
                                        <span data-i18n="normal">–ù–æ—Ä–º–∞–ª—å–Ω—ã–π</span>
                                        <span>High</span>
                                    </div>
                                </div>

                                <div class="voice-control">
                                    <label for="voiceVolumeSlider">
                                        <span data-i18n="volume">–ì—Ä–æ–º–∫–æ—Å—Ç—å: <span id="voiceVolumeValue">100%</span></span>
                                    </label>
                                    <input type="range" id="voiceVolumeSlider" min="0" max="1" step="0.1" value="1" class="voice-slider">
                                    <div class="slider-labels">
                                        <span>0%</span>
                                        <span>50%</span>
                                        <span>100%</span>
                                    </div>
                                </div>

                                <button id="testVoiceSettingsBtn" class="action-btn" style="margin-top: 10px;">
                                    üîä <span data-i18n="test_with_current_settings">–¢–µ—Å—Ç —Å —Ç–µ–∫—É—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    -->

                    <div class="settings-group">
                        <h3 data-i18n="audio_settings">üîä –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏</h3>
                        <div class="setting-item">
                            <label class="setting-label">
                                <input type="checkbox" id="autoPlayCheckbox" checked>
                                <span data-i18n="auto_play_words">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å–ª–æ–≤</span>
                            </label>
                            <p class="setting-description" data-i18n="auto_play_description">
                                –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–∑–≤—É—á–∏–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è—Ö
                            </p>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3>Synchronization</h3>
                        <button id="syncBtn" class="action-btn" data-i18n="sync">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–æm</button>
                        <div id="syncStatus" class="sync-status"></div>
                    </div>

                    <div class="settings-group">
                        <h3 data-i18n="training_intro">üëã –û–±—É—á–µ–Ω–∏–µ</h3>
                        <p style="font-size: 14px; color: #6c757d; margin-bottom: 12px;">
                            Repeat interactive tour <span data-i18n="app_features_tour">–ø–æ —Ñ—É–Ω–∫—Ü–∏—è–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span>
                        </p>
                        <button id="restartOnboardingBtn" class="action-btn secondary-btn">
                            üéØ <span data-i18n="start_tour_again">–ù–∞—á–∞—Ç—å —Ç—É—Ä –∑–∞–Ω–æ–≤–æ</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Daily Challenges Section -->
            <section id="challengesSection" class="section">
                <h2 data-i18n="daily_challenges">üéØ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h2>
                <p class="section-description" data-i18n="challenges_description">
                    –í—ã–ø–æ–ª–Ω—è–π –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏ –ø–æ–ª—É—á–∞–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã! –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–æ–≤—ã–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏.
                </p>

                <div id="challengesContainer" class="challenges-container">
                    <!-- Challenges will be rendered here by JavaScript -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>

                <!-- Challenges Stats -->
                <div class="challenges-stats">
                    <div class="stat-card">
                        <h3 data-i18n="challenges_completed_today">–í—ã–ø–æ–ª–Ω–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</h3>
                        <p id="challengesCompletedToday">0/3</p>
                    </div>
                    <div class="stat-card">
                        <h3 data-i18n="challenges_streak">–°–µ—Ä–∏—è –¥–Ω–µ–π</h3>
                        <p id="challengesStreak">0 <span data-i18n="days_short">–¥–Ω.</span></p>
                    </div>
                    <div class="stat-card">
                        <h3 data-i18n="challenges_total">–í—Å–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</h3>
                        <p id="challengesTotal">0</p>
                    </div>
                </div>
            </section>

            <!-- Streak Freeze Section -->
            <section id="streakFreezeSection" class="section">
                <h2>‚ùÑÔ∏è <span data-i18n="streak_freeze_title">–ó–∞–º–æ—Ä–æ–∑–∫–∞ —Å—Ç—Ä–∏–∫–∞</span></h2>
                <p class="section-description" data-i18n="streak_freeze_description">
                    –ó–∞—â–∏—Ç–∏ —Å–≤–æ–π —Å—Ç—Ä–∏–∫ –æ—Ç –ø–æ—Ç–µ—Ä–∏! –ò—Å–ø–æ–ª—å–∑—É–π –∑–∞–º–æ—Ä–æ–∑–∫—É, –µ—Å–ª–∏ –Ω–µ –º–æ–∂–µ—à—å –∑–∞–Ω–∏–º–∞—Ç—å—Å—è.
                </p>

                <!-- Active Freezes -->
                <div class="freeze-status-card">
                    <h3 data-i18n="active_freezes">–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–º–æ—Ä–æ–∑–∫–∏</h3>
                    <div id="activeFreezes" class="active-freezes-list">
                        <div class="loading-spinner">
                            <div class="spinner"></div>
                            <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                    </div>
                </div>

                <!-- Use Freeze -->
                <div class="use-freeze-card">
                    <h3 data-i18n="use_freeze">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–º–æ—Ä–æ–∑–∫—É</h3>
                    <p data-i18n="use_freeze_description" style="font-size: 14px; color: #6c757d; margin-bottom: 16px;">
                        –ê–∫—Ç–∏–≤–∏—Ä—É–π –∑–∞–º–æ—Ä–æ–∑–∫—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å, —á—Ç–æ–±—ã –∑–∞—â–∏—Ç–∏—Ç—å —Å—Ç—Ä–∏–∫ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
                    </p>
                    <button id="useFreezeBtn" class="action-btn" disabled>
                        ‚ùÑÔ∏è <span data-i18n="use_freeze_button">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–º–æ—Ä–æ–∑–∫—É</span>
                    </button>
                    <p id="freezeStatus" style="margin-top: 12px; font-size: 14px;"></p>
                </div>

                <!-- Get Free Freeze -->
                <div class="free-freeze-card">
                    <h3 data-i18n="free_freeze">–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∑–∞–º–æ—Ä–æ–∑–∫–∞</h3>
                    <p data-i18n="free_freeze_description" style="font-size: 14px; color: #6c757d; margin-bottom: 16px;">
                        –ü–æ–ª—É—á–∞–π 1 –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –∑–∞–º–æ—Ä–æ–∑–∫—É –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é!
                    </p>
                    <button id="claimFreeFreezeBtn" class="action-btn secondary-btn">
                        üéÅ <span data-i18n="claim_free_freeze">–ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –∑–∞–º–æ—Ä–æ–∑–∫—É</span>
                    </button>
                </div>

                <!-- Freeze History -->
                <div class="freeze-history-card">
                    <h3 data-i18n="freeze_history">–ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h3>
                    <div id="freezeHistory" class="freeze-history-list">
                        <!-- History will be rendered here -->
                    </div>
                </div>
            </section>

            <!-- Leagues Section (Gamification - Limited Access) -->
            <section id="leaguesSection" class="section">
                <h2>üèÜ <span data-i18n="leagues_title">–õ–∏–≥–∏</span></h2>
                <p class="section-description" data-i18n="leagues_description">
                    –°–æ—Ä–µ–≤–Ω—É–π—Å—è —Å –¥—Ä—É–≥–∏–º–∏ —É—á–µ–Ω–∏–∫–∞–º–∏! –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π XP –∏ –ø–æ–¥–Ω–∏–º–∞–π—Å—è –ø–æ –ª–∏–≥–∞–º.
                </p>

                <div id="leaguesContent">
                    <!-- Leagues UI will be rendered here by JavaScript -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </section>

            <!-- Weekly Challenges Section (Gamification - Limited Access) -->
            <section id="weeklyChallengesSection" class="section">
                <h2>üìÖ <span data-i18n="weekly_challenges_title">–ù–µ–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</span></h2>
                <p class="section-description" data-i18n="weekly_challenges_description">
                    –í—ã–ø–æ–ª–Ω—è–π –Ω–µ–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏ –ø–æ–ª—É—á–∞–π –±–æ–ª—å—à–∏–µ –Ω–∞–≥—Ä–∞–¥—ã!
                </p>

                <div id="weeklyChallengesContent">
                    <!-- Weekly Challenges UI will be rendered here by JavaScript -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </section>

            <!-- Personal Rating Section (Gamification - Limited Access) -->
            <section id="personalRatingSection" class="section">
                <h2>üìä <span data-i18n="personal_rating_title">–ú–æ–π —Ä–µ–π—Ç–∏–Ω–≥</span></h2>
                <p class="section-description" data-i18n="personal_rating_description">
                    –û—Ç—Å–ª–µ–∂–∏–≤–∞–π —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –Ω–µ–¥–µ–ª—è–º –∏ –º–µ—Å—è—Ü–∞–º!
                </p>

                <div id="personalRatingContent">
                    <!-- Personal Rating UI will be rendered here by JavaScript -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </section>

            <!-- Personal Insights Section (Gamification - Limited Access) -->
            <section id="personalInsightsSection" class="section">
                <h2>üí° <span data-i18n="personal_insights_title">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã</span></h2>
                <p class="section-description" data-i18n="personal_insights_description">
                    –£–∑–Ω–∞–π –±–æ–ª—å—à–µ –æ —Å–≤–æ—ë–º —Å—Ç–∏–ª–µ –æ–±—É—á–µ–Ω–∏—è –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ!
                </p>

                <div id="personalInsightsContent">
                    <!-- Personal Insights UI will be rendered here by JavaScript -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </section>

            <!-- Friends Section (Social - Limited Access) -->
            <section id="friendsSection" class="section">
                <h2>üë• <span data-i18n="friends_title">Friends</span></h2>
                <p class="section-description" data-i18n="friends_description">
                    Connect with other learners and track progress together!
                </p>

                <div id="friendsContent">
                    <!-- Friends UI will be rendered here by JavaScript -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </section>

            <!-- Duels Section -->
            <section id="duelsSection" class="section">
                <h2>‚öîÔ∏è <span data-i18n="duels_title">Duels</span></h2>
                <p class="section-description" data-i18n="duels_description">
                    Challenge your friends to 1v1 word battles and compete for the top spot!
                </p>

                <div id="duelsContent">
                    <!-- Duels UI will be rendered here by JavaScript -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </section>

            <!-- Profile Section (View only - no nav button) -->
            <section id="profileSection" class="section">
                <h2>üë§ <span data-i18n="profile_title">Profile</span></h2>

                <div id="profileContent">
                    <!-- Profile UI will be rendered here by JavaScript -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </section>

            <!-- Achievements Section (Limited Access) -->
            <section id="achievementsSection" class="section">
                <h2>üèÜ <span data-i18n="achievements_title">Achievements</span></h2>
                <p class="section-description" data-i18n="achievements_description">
                    Unlock achievements as you learn and progress!
                </p>

                <div id="achievementsContent">
                    <!-- Achievements UI will be rendered here by JavaScript -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </section>

            <!-- Bug Reports Section -->
            <section id="bugReportsSection" class="section">
                <h2>üêõ <span data-i18n="bug_reports">–°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ</span></h2>
                <p class="section-description" data-i18n="bug_reports_description">
                    –ù–∞—à–ª–∏ –æ—à–∏–±–∫—É –∏–ª–∏ –±–∞–≥? –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É, –∏ –º—ã –µ—ë –∏—Å–ø—Ä–∞–≤–∏–º!
                </p>

                <form id="bugReportForm" class="bug-report-form">
                    <div class="form-group">
                        <label for="bugTitle">
                            <span data-i18n="bug_title">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</span> *
                        </label>
                        <input
                            type="text"
                            id="bugTitle"
                            required
                            maxlength="200"
                            data-i18n-placeholder="bug_title_placeholder"
                            placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã"
                        >
                    </div>

                    <div class="form-group">
                        <label for="bugDescription">
                            <span data-i18n="bug_description">–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</span> *
                        </label>
                        <textarea
                            id="bugDescription"
                            required
                            rows="6"
                            maxlength="2000"
                            data-i18n-placeholder="bug_description_placeholder"
                            placeholder="–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ, –∫–∞–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –æ—à–∏–±–∫—É, –∫–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–∂–∏–¥–∞–ª–∏"
                        ></textarea>
                        <small data-i18n="characters_left">–û—Å—Ç–∞–ª–æ—Å—å —Å–∏–º–≤–æ–ª–æ–≤: <span id="charCount">2000</span></small>
                    </div>

                    <div class="form-group">
                        <label for="bugSeverity">
                            <span data-i18n="bug_severity">–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å</span> *
                        </label>
                        <select id="bugSeverity" required>
                            <option value="low" data-i18n="severity_low">–ù–∏–∑–∫–∞—è (–∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∞—è)</option>
                            <option value="medium" data-i18n="severity_medium" selected>–°—Ä–µ–¥–Ω—è—è (–≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É)</option>
                            <option value="high" data-i18n="severity_high">–í—ã—Å–æ–∫–∞—è (–±–ª–æ–∫–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é)</option>
                            <option value="critical" data-i18n="severity_critical">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è (–∫—Ä–∞—à –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="bugSteps">
                            <span data-i18n="bug_steps">–®–∞–≥–∏ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è</span>
                        </label>
                        <textarea
                            id="bugSteps"
                            rows="4"
                            maxlength="1000"
                            data-i18n-placeholder="bug_steps_placeholder"
                            placeholder="1. –û—Ç–∫—Ä—ã—Ç—å —Ä–∞–∑–¥–µ–ª... 2. –ù–∞–∂–∞—Ç—å –Ω–∞... 3. –£–≤–∏–¥–µ—Ç—å –æ—à–∏–±–∫—É..."
                        ></textarea>
                    </div>

                    <div class="form-buttons">
                        <button type="submit" class="action-btn">
                            üì§ <span data-i18n="send_bug_report">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á—ë—Ç</span>
                        </button>
                        <button type="reset" class="action-btn secondary-btn">
                            üîÑ <span data-i18n="reset_form">–û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É</span>
                        </button>
                    </div>
                </form>

                <!-- Recent Reports -->
                <div class="recent-reports-card">
                    <h3 data-i18n="my_bug_reports">–ú–æ–∏ –æ—Ç—á—ë—Ç—ã</h3>
                    <div id="recentBugReports" class="bug-reports-list">
                        <div class="loading-spinner">
                            <div class="spinner"></div>
                            <p data-i18n="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Version Info -->
<!--         <footer style="position: fixed; bottom: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 5px; font-size: 12px; z-index: 10000;">
            v5.1.2-UPDATE-7931e19
        </footer> -->

        <!-- New Version Indicator -->
        <div id="newVersionIndicator" style="position: fixed; top: 10px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #8B5CF6, #06B6D4); color: white; padding: 10px 20px; border-radius: 25px; font-weight: bold; z-index: 10001; box-shadow: 0 4px 12px rgba(0,0,0,0.3); animation: pulse 2s infinite;">
            ‚ú® NEW VERSION LOADED! ‚ú®
        </div>

        <style>
            @keyframes pulse {
                0% { transform: translateX(-50%) scale(1); }
                50% { transform: translateX(-50%) scale(1.05); }
                100% { transform: translateX(-50%) scale(1); }
            }
        </style>

        <script>
            // Hide indicator after 5 seconds
            setTimeout(() => {
                const indicator = document.getElementById('newVersionIndicator');
                if (indicator) {
                    indicator.style.transition = 'opacity 1s ease-out';
                    indicator.style.opacity = '0';
                    setTimeout(() => indicator.remove(), 1000);
                }
            }, 5000);
        </script>
    </div>

    <!-- Chart.js for analytics visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <script src="theme.js"></script>
    <script src="toast.js"></script>
    <script src="api-database.js"></script>
    <script src="quiz.js"></script>
    <script src="i18n.js"></script>
    <script src="language-manager.js"></script>
    <script src="user-manager.js"></script>
    <script src="survival-mode.js"></script>
    <script src="gamification.js"></script>
    <script src="analytics.js"></script>
    <!-- <script src="onboarding.js"></script> -->
    <script src="features-ui.js"></script>
    <script src="leagues-ui.js"></script>
    <script src="weekly-challenges-ui.js"></script>
    <script src="personal-rating-ui.js"></script>
    <script src="personal-insights-ui.js"></script>
    <script src="friends-ui.js"></script>
    <script src="duels-ui.js"></script>
    <script src="duel-gameplay.js"></script>
    <script src="profile-ui.js"></script>
    <script src="achievements-ui.js"></script>
    <script src="word-lists-ui.js"></script>
    <script src="app.js"></script>

    <script>
        // Auto-detect device language and pre-select in registration form
        document.addEventListener('DOMContentLoaded', function() {
            const nativeSelect = document.getElementById('registerNativeLang');
            const targetSelect = document.getElementById('registerTargetLang');
            
            if (nativeSelect && targetSelect) {
                // Get device language (e.g., "en-US" ‚Üí "en")
                const browserLang = navigator.language.split('-')[0].toLowerCase();
                const supportedLangs = ['en', 'de', 'es', 'fr', 'ru', 'uk', 'pt', 'it', 'zh', 'ja', 'ko'];
                
                const nativeLang = supportedLangs.includes(browserLang) ? browserLang : 'en';
                const targetLang = nativeLang === 'en' ? 'es' : 'en';
                
                // Set native language
                nativeSelect.value = nativeLang;
                
                // Set target language
                targetSelect.value = targetLang;
                
                console.log('üåç Auto-detected language:', browserLang, '‚Üí Native:', nativeLang, ', Target:', targetLang);
            }
        });
    </script>
</body>
</html>